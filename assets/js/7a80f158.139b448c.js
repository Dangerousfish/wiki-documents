"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[59543],{15680:(e,r,t)=>{t.d(r,{xA:()=>c,yg:()=>g});var i=t(96540);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,i,a=function(e,r){if(null==e)return{};var t,i,a={},n=Object.keys(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=i.createContext({}),l=function(e){var r=i.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},c=function(e){var r=l(e.components);return i.createElement(p.Provider,{value:r},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return i.createElement(i.Fragment,{},r)}},y=i.forwardRef((function(e,r){var t=e.components,a=e.mdxType,n=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(t),y=a,g=d["".concat(p,".").concat(y)]||d[y]||u[y]||n;return t?i.createElement(g,o(o({ref:r},c),{},{components:t})):i.createElement(g,o({ref:r},c))}));function g(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var n=t.length,o=new Array(n);o[0]=y;var s={};for(var p in r)hasOwnProperty.call(r,p)&&(s[p]=r[p]);s.originalType=e,s[d]="string"==typeof e?e:a,o[1]=s;for(var l=2;l<n;l++)o[l]=t[l];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}y.displayName="MDXCreateElement"},26511:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>n,metadata:()=>s,toc:()=>l});var i=t(9668),a=(t(96540),t(15680));const n={description:"Getting Started with Raspberry Pi",title:"Getting Started with Raspberry Pi",keywords:["ReSpeaker_2-Mics_Pi_HAT"],image:"https://files.seeedstudio.com/wiki/ReSpeaker_2_Mics_Pi_HAT/social-image.webp",slug:"/respeaker_2_mics_pi_hat_raspberry_v2",last_update:{date:"12/11/2024",author:"Joshua Lee"}},o=void 0,s={unversionedId:"Sensor/ReSpeaker_2-Mics_Pi_HAT/v2/ReSpeaker_2_Mics_Pi_HAT_Raspberry_v2",id:"Sensor/ReSpeaker_2-Mics_Pi_HAT/v2/ReSpeaker_2_Mics_Pi_HAT_Raspberry_v2",title:"Getting Started with Raspberry Pi",description:"Getting Started with Raspberry Pi",source:"@site/docs/Sensor/ReSpeaker_2-Mics_Pi_HAT/v2/ReSpeaker_2_Mics_Pi_HAT_Raspberry_v2.md",sourceDirName:"Sensor/ReSpeaker_2-Mics_Pi_HAT/v2",slug:"/respeaker_2_mics_pi_hat_raspberry_v2",permalink:"/respeaker_2_mics_pi_hat_raspberry_v2",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/ReSpeaker_2-Mics_Pi_HAT/v2/ReSpeaker_2_Mics_Pi_HAT_Raspberry_v2.md",tags:[],version:"current",lastUpdatedBy:"Joshua Lee",lastUpdatedAt:1733875200,formattedLastUpdatedAt:"Dec 11, 2024",frontMatter:{description:"Getting Started with Raspberry Pi",title:"Getting Started with Raspberry Pi",keywords:["ReSpeaker_2-Mics_Pi_HAT"],image:"https://files.seeedstudio.com/wiki/ReSpeaker_2_Mics_Pi_HAT/social-image.webp",slug:"/respeaker_2_mics_pi_hat_raspberry_v2",last_update:{date:"12/11/2024",author:"Joshua Lee"}},sidebar:"ProductSidebar",previous:{title:"Getting started with Nvidia Jetson",permalink:"/ReSpeaker_2_Mics_Pi_HAT_Jetson"},next:{title:"How to Distinguish ReSpeaker 2-Mics Pi HAT Hardware Revisions",permalink:"/how-to-distinguish-respeaker_2-mics_pi_hat-hardware-revisions"}},p={},l=[{value:"Driver installation and configuration",id:"driver-installation-and-configuration",level:2},{value:"1. Connect ReSpeaker 2-Mics Pi HAT to Raspberry Pi",id:"1-connect-respeaker-2-mics-pi-hat-to-raspberry-pi",level:3},{value:"2. Setup the driver on Raspberry Pi",id:"2-setup-the-driver-on-raspberry-pi",level:3},{value:"3. Configure sound settings and adjust the volume with alsamixer",id:"3-configure-sound-settings-and-adjust-the-volume-with-alsamixer",level:3},{value:"Usage overview",id:"usage-overview",level:2},{value:"APA102 LEDs",id:"apa102-leds",level:3},{value:"User Button",id:"user-button",level:3},{value:"Non-Raspberry Pi 5 device",id:"non-raspberry-pi-5-device",level:4},{value:"Raspberry Pi 5 device",id:"raspberry-pi-5-device",level:4},{value:"Record sound with Python",id:"record-sound-with-python",level:3},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],c={toc:l},d="wrapper";function u(e){let{components:r,...t}=e;return(0,a.yg)(d,(0,i.A)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,a.yg)("admonition",{type:"caution"},(0,a.yg)("p",{parentName:"admonition"},"This wiki is wrote for ReSpeaker 2-Mics Pi HAT ",(0,a.yg)("strong",{parentName:"p"},"v2"),", to distinguish the v1 and v2 device, please refer to ",(0,a.yg)("a",{parentName:"p",href:"/how-to-distinguish-respeaker_2-mics_pi_hat-hardware-revisions"},"How to Distinguish ReSpeaker 2-Mics Pi HAT Hardware Revisions"),".")),(0,a.yg)("p",null,"On the latest Raspberry Pi OS, the traditional method of driver installation (For v1 device) is no longer available and may lead to the following known issues:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"The desktop environment may be corrupted after installation."),(0,a.yg)("li",{parentName:"ul"},"The ReSpeaker device may not able to be detected by ",(0,a.yg)("inlineCode",{parentName:"li"},"aplay")," / ",(0,a.yg)("inlineCode",{parentName:"li"},"arecord"),".")),(0,a.yg)("p",null,"We have therefore re-released a new wiki on this issue, if you are using the more modern Raspberry Pi OS rather than previous releases, please follow these steps to get your ReSpeaker working."),(0,a.yg)("h2",{id:"driver-installation-and-configuration"},"Driver installation and configuration"),(0,a.yg)("h3",{id:"1-connect-respeaker-2-mics-pi-hat-to-raspberry-pi"},"1. Connect ReSpeaker 2-Mics Pi HAT to Raspberry Pi"),(0,a.yg)("p",null,"Mount ReSpeaker 2-Mics Pi HAT on your Raspberry Pi, make sure that the pins are properly aligned when stacking the ReSpeaker 2-Mics Pi HAT."),(0,a.yg)("p",null,"Raspberry Pi Connection"),(0,a.yg)("p",null,(0,a.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/MIC_HATv1.0_for_raspberrypi/img/pi.png",alt:"connection picture1"})),(0,a.yg)("p",null,"Raspberry Pi Zero Connection"),(0,a.yg)("p",null,(0,a.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/products/107100001/01.png",alt:"connection picture2"})),(0,a.yg)("h3",{id:"2-setup-the-driver-on-raspberry-pi"},"2. Setup the driver on Raspberry Pi"),(0,a.yg)("p",null,"Make sure that you are running ",(0,a.yg)("a",{parentName:"p",href:"https://www.raspberrypi.com/software/operating-systems/"},"the latest Raspberry Pi OS")," on your Pi. ",(0,a.yg)("em",{parentName:"p"},"(updated at 2024.11.19)")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Step 1: Get Device Tree Source (DTS) for the ReSpeaker 2-Mics Pi HAT (V2.0), compile it and install the device tree overlay.")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ curl https://raw.githubusercontent.com/Seeed-Studio/seeed-linux-dtoverlays/refs/heads/master/overlays/rpi/respeaker-2mic-v2_0-overlay.dts -o respeaker-2mic-v2_0-overlay.dts\n$ dtc -I dts respeaker-2mic-v2_0-overlay.dts -o respeaker-2mic-v2_0-overlay.dtbo\n$ sudo dtoverlay respeaker-2mic-v2_0-overlay.dtbo\n")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Step 2: Edit ",(0,a.yg)("inlineCode",{parentName:"li"},"/boot/firmware/config.txt")," and add the following lines:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"dtoverlay=respeaker-2mic-v2_0-overlay\n")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Step 3: Reboot your Pi.")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ sudo reboot\n")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Step 4: Check if the device is detected by ",(0,a.yg)("inlineCode",{parentName:"li"},"aplay")," / ",(0,a.yg)("inlineCode",{parentName:"li"},"arecord"),".")),(0,a.yg)("p",null,"The expected output for ",(0,a.yg)("inlineCode",{parentName:"p"},"aplay")," should be:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"$ aplay -l\n**** List of PLAYBACK Hardware Devices ****\ncard 0: vc4hdmi0 [vc4-hdmi-0], device 0: MAI PCM i2s-hifi-0 [MAI PCM i2s-hifi-0]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\ncard 1: vc4hdmi1 [vc4-hdmi-1], device 0: MAI PCM i2s-hifi-0 [MAI PCM i2s-hifi-0]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\ncard 2: seeed2micvoicec [seeed2micvoicec], device 0: 1f000a4000.i2s-tlv320aic3x-hifi tlv320aic3x-hifi-0 [1f000a4000.i2s-tlv320aic3x-hifi tlv320aic3x-hifi-0]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\n")),(0,a.yg)("p",null,"The expected output for ",(0,a.yg)("inlineCode",{parentName:"p"},"arecord")," should be:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"$ arecord -l\n**** List of CAPTURE Hardware Devices ****\ncard 2: seeed2micvoicec [seeed2micvoicec], device 0: 1f000a4000.i2s-tlv320aic3x-hifi tlv320aic3x-hifi-0 [1f000a4000.i2s-tlv320aic3x-hifi tlv320aic3x-hifi-0]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Where the ",(0,a.yg)("inlineCode",{parentName:"strong"},"card 2")," is the index of the ReSpeaker 2-Mics Pi HAT, depending on your system this number may differ. To access the ReSpeaker in this example, you can use ",(0,a.yg)("inlineCode",{parentName:"strong"},"arecord -D plughw:2,0")," or ",(0,a.yg)("inlineCode",{parentName:"strong"},"aplay -D plughw:2,0"),".")),(0,a.yg)("h3",{id:"3-configure-sound-settings-and-adjust-the-volume-with-alsamixer"},"3. Configure sound settings and adjust the volume with alsamixer"),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"alsamixer")," is a terminal user interface mixer program for the Advanced Linux Sound Architecture (ALSA) that is used to configure sound settings and adjust the volume."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ alsamixer\n")),(0,a.yg)("p",null,(0,a.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/MIC_HATv1.0_for_raspberrypi/img/alsamixer.png",alt:null})),(0,a.yg)("p",null,"The Left and right arrow keys are used to select the channel or device and the Up and Down Arrows control the volume for the currently selected device. Quit the program with ALT+Q, or by hitting the Esc key. ",(0,a.yg)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Alsamixer"},"More information")),(0,a.yg)("admonition",{type:"caution"},(0,a.yg)("pre",{parentName:"admonition"},(0,a.yg)("code",{parentName:"pre"},"Please use the F6 to select seeed-2mic-voicecard device first.\n"))),(0,a.yg)("h2",{id:"usage-overview"},"Usage overview"),(0,a.yg)("p",null,"To get started, clone ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/respeaker/mic_hat.git"},"https://github.com/respeaker/mic_hat.git")," repository to your Raspberry Pi."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/respeaker/mic_hat.git\ncd mic_hat\n")),(0,a.yg)("p",null,"All the Python scripts, mentioned in the examples below can be found inside this repository. To install the necessary dependencies, from mic_hat repository folder, run"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install portaudio19-dev libatlas-base-dev\npip3 install -r requirements.txt\n")),(0,a.yg)("h3",{id:"apa102-leds"},"APA102 LEDs"),(0,a.yg)("p",null,"To use the LEDs, you need enable SPI interface first. To enable SPI interface, open the Raspberry Pi software configuration tool:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ sudo raspi-config\n")),(0,a.yg)("p",null,'Choose "3 Interface Options" -> "I4 SPI" to enable SPI interface. Then reboot your Raspberry Pi.'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ sudo reboot\n")),(0,a.yg)("p",null,"Each on-board APA102 LED has an additional driver chip. The driver chip takes care of receiving the desired color via its input lines, and then holding this color until a new command is received."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python3 interfaces/pixels.py\n")),(0,a.yg)("video",{width:512,height:384,controls:!0,preload:!0},(0,a.yg)("source",{src:"https://files.seeedstudio.com/wiki/MIC_HATv1.0_for_raspberrypi/img/led.mp4"}),(0,a.yg)("source",{src:"https://files.seeedstudio.com/wiki/MIC_HATv1.0_for_raspberrypi/img/led.webmhd.webm"})),(0,a.yg)("h3",{id:"user-button"},"User Button"),(0,a.yg)("p",null,"There is an on-board User Button, which is connected to GPIO_17."),(0,a.yg)("admonition",{type:"caution"},(0,a.yg)("pre",{parentName:"admonition"},(0,a.yg)("code",{parentName:"pre"},"The demo code from repository is not available for Raspberry Pi 5 due to `RPI.GPIO` incompatibility. But we have provided an alternative demo code for Raspberry Pi 5 using `gpiozero` library.\n"))),(0,a.yg)("h4",{id:"non-raspberry-pi-5-device"},"Non-Raspberry Pi 5 device"),(0,a.yg)("p",null,'Execute the example script from the repository which you cloned at Step 4, and it should display "on" when you press the button:'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-txt"},"$ python3 button.py\noff\noff\non\non\noff\n")),(0,a.yg)("h4",{id:"raspberry-pi-5-device"},"Raspberry Pi 5 device"),(0,a.yg)("p",null,"Copy the following code and save it to ",(0,a.yg)("inlineCode",{parentName:"p"},"~/button.py"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-python"},'from gpiozero import DigitalInputDevice\nfrom time import sleep\n\ndef main():\n    pin = DigitalInputDevice(pin=17, pull_up=True)\n    try:\n        while True:\n            print("on" if pin.value == 1 else "off")\n            sleep(1)\n    finally:\n        pin.close()\n\nif __name__ == \'__main__\':\n    main()\n')),(0,a.yg)("p",null,'It should also display "on" when you press the button:'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ python3 ~/button.py\noff\non\non\noff\non\noff\n")),(0,a.yg)("h3",{id:"record-sound-with-python"},"Record sound with Python"),(0,a.yg)("p",null,"We use ",(0,a.yg)("a",{parentName:"p",href:"https://people.csail.mit.edu/hubert/pyaudio/"},"PyAudio python library")," to record sound with Python."),(0,a.yg)("p",null,"First, run the following script to get the device index number of ReSpeaker:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python3 recording_examples/get_device_index.py\n")),(0,a.yg)("p",null,"You will see the device ID as below."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"Input Device id  1  -  seeed2micvoicec: 1f000a4000.i2s-tlv320aic3x-hifi tlv320aic3x-hifi-0 (hw:2,0)\n")),(0,a.yg)("p",null,"To record the sound, open ",(0,a.yg)("inlineCode",{parentName:"p"},"recording_examples/record.py")," file with ",(0,a.yg)("inlineCode",{parentName:"p"},"nano"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"vim")," or other text editor and change ",(0,a.yg)("inlineCode",{parentName:"p"},"RESPEAKER_INDEX = 2")," to index number of ReSpeaker on your system. Then run python script ",(0,a.yg)("inlineCode",{parentName:"p"},"record.py")," to make a recording:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python3 recording_examples/record.py\n")),(0,a.yg)("p",null,"If you want to extract channel 0 data from 2 channels, have a look at the content of ",(0,a.yg)("inlineCode",{parentName:"p"},"record_one_channel.py"),". For other channel X, please change ","[0::2]"," to ","[X::2]","."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python3 recording_examples/record_one_channel.py\n")),(0,a.yg)("p",null,"To play the recorded samples you can either use aplay system utility, for example"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"aplay -f cd -D hw:2,0 output.wav # for Stereo sound\naplay -D plughw:2,0 output_one_channel.wav #for Mono sound from one channel\n")),(0,a.yg)("p",null,"Alternatively you can use recording_examples/play.py script to play the .wav files with PyAudio."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python3 recording_examples/play.py path-to-wav-file\n")),(0,a.yg)("p",null,"Make sure to specify the right output device index in play.py - otherwise PyAudio will freeze!"),(0,a.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,a.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,a.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,a.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}u.isMDXComponent=!0}}]);