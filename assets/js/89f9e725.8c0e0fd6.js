"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[67878],{15680:(e,t,a)=>{a.d(t,{xA:()=>d,yg:()=>g});var o=a(96540);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=o.createContext({}),l=function(e){var t=o.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=l(e.components);return o.createElement(p.Provider,{value:t},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),h=l(a),u=n,g=h["".concat(p,".").concat(u)]||h[u]||c[u]||r;return a?o.createElement(g,i(i({ref:t},d),{},{components:a})):o.createElement(g,i({ref:t},d))}));function g(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[h]="string"==typeof e?e:n,i[1]=s;for(var l=2;l<r;l++)i[l]=a[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}u.displayName="MDXCreateElement"},24989:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var o=a(9668),n=(a(96540),a(15680));const r={description:"Send data from Watcher & Node-RED to WhatsApp",title:"Watcher & Node-RED to WhatsApp",keywords:["Watcher","WhatsApp","Node-RED"],image:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/watcher_whatsapp.png",slug:"/watcher_node_red_to_whatsapp",last_update:{date:"07/25/2024",author:"Vincent"}},i="Watcher To WhatsApp Quick Start",s={unversionedId:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_whatsapp",id:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_whatsapp",title:"Watcher & Node-RED to WhatsApp",description:"Send data from Watcher & Node-RED to WhatsApp",source:"@site/docs/Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_whatsapp.md",sourceDirName:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration",slug:"/watcher_node_red_to_whatsapp",permalink:"/watcher_node_red_to_whatsapp",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_whatsapp.md",tags:[],version:"current",lastUpdatedBy:"Vincent",lastUpdatedAt:1721865600,formattedLastUpdatedAt:"Jul 25, 2024",frontMatter:{description:"Send data from Watcher & Node-RED to WhatsApp",title:"Watcher & Node-RED to WhatsApp",keywords:["Watcher","WhatsApp","Node-RED"],image:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/watcher_whatsapp.png",slug:"/watcher_node_red_to_whatsapp",last_update:{date:"07/25/2024",author:"Vincent"}},sidebar:"ProductSidebar",previous:{title:"Watcher & Node-RED to MongoDB",permalink:"/watcher_node_red_to_mongodb"},next:{title:"mmWave Radar Sensor Guide",permalink:"/mmwave_radar_Intro"}},p={},l=[{value:"Part 1. Set up Watcher in Node-RED",id:"part-1-set-up-watcher-in-node-red",level:2},{value:"Step 1. Set up Node-RED",id:"step-1-set-up-node-red",level:3},{value:"Step 2. Get data from Watcher",id:"step-2-get-data-from-watcher",level:3},{value:"Example Node-RED Function to Format Data",id:"example-node-red-function-to-format-data",level:4},{value:"Part 2. Set up WhatsApp API",id:"part-2-set-up-whatsapp-api",level:2},{value:"Step 3. Sign up for WhatsApp",id:"step-3-sign-up-for-whatsapp",level:3},{value:"Step 4. Get CallMeBot API Key",id:"step-4-get-callmebot-api-key",level:3},{value:"Part 3. Integrate WhatsApp with Node-RED",id:"part-3-integrate-whatsapp-with-node-red",level:2},{value:"Step 5. Install WhatsApp module",id:"step-5-install-whatsapp-module",level:3},{value:"Step 6. Configure WhatsApp node",id:"step-6-configure-whatsapp-node",level:3},{value:"Step 7. Deploy",id:"step-7-deploy",level:3},{value:"Debugging: Node-RED Errors",id:"debugging-node-red-errors",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],d={toc:l},h="wrapper";function c(e){let{components:t,...a}=e;return(0,n.yg)(h,(0,o.A)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"watcher-to-whatsapp-quick-start"},"Watcher To WhatsApp Quick Start"),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/watcher_whatsapp.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("p",null,(0,n.yg)("a",{parentName:"p",href:"https://web.whatsapp.com/"},(0,n.yg)("strong",{parentName:"a"},"WhatsApp"))," is an instant messaging and voice-over-IP service owned by Meta. It enables users to send text, voice, and video messages, make voice and video calls, and share images, documents, locations, and other content."),(0,n.yg)("p",null,"This tutorial will guide you through integrating the Watcher API with Node-RED to seamlessly send data from the Watcher to WhatsApp. This integration provides a simple and efficient method to ",(0,n.yg)("strong",{parentName:"p"},"receive notifications and opens the door for further applications and integrations"),"."),(0,n.yg)("h2",{id:"part-1-set-up-watcher-in-node-red"},"Part 1. Set up Watcher in Node-RED"),(0,n.yg)("h3",{id:"step-1-set-up-node-red"},"Step 1. Set up Node-RED"),(0,n.yg)("p",null,"Fisrt of all, you need to run a task in Watcher following the video below. If you want to know more ",(0,n.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/getting_started_with_watcher_task/"},"please click here"),"."),(0,n.yg)("div",{class:"table-center"},(0,n.yg)("iframe",{width:"600",height:"338",src:"https://files.seeedstudio.com/wiki/watcher_to_open_interpreter_image/run_task.mp4?autoplay=0",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}," ")),(0,n.yg)("p",null,"Node-RED is required for this setup, along with the Watcher API. If you haven't installed Node-RED or connected it with the Watcher API, start here: ",(0,n.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/watcher_to_node_red"},(0,n.yg)("strong",{parentName:"a"},"Watcher to Node-RED Quick Start")),"."),(0,n.yg)("h3",{id:"step-2-get-data-from-watcher"},"Step 2. Get data from Watcher"),(0,n.yg)("p",null,"After setting up the Watcher to work with Node-RED, the next step is to prepare the data from the Watcher for WhatsApp. Double click the function node to format the data appropriately."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_1.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("p",null,"For the purpose of this tutorial, we will be sending the content as well as the the image URL. However, you are encouraged to transform the data as needed for your application."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_2.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("h4",{id:"example-node-red-function-to-format-data"},"Example Node-RED Function to Format Data"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-sh"},"node.send({ payload: msg.payload.value[0].content });\n\nnode.send({ payload: msg.payload.value[0].image_url });\n")),(0,n.yg)("h2",{id:"part-2-set-up-whatsapp-api"},"Part 2. Set up WhatsApp API"),(0,n.yg)("h3",{id:"step-3-sign-up-for-whatsapp"},"Step 3. Sign up for WhatsApp"),(0,n.yg)("p",null,"A WhatsApp account is required to proceed. If you do not already have an account, please ",(0,n.yg)("a",{parentName:"p",href:"https://www.whatsapp.com"},(0,n.yg)("strong",{parentName:"a"},"click here"))," and complete the steps to create an account."),(0,n.yg)("p",null,"If you already have an account, please proceed to ",(0,n.yg)("a",{parentName:"p",href:"#step-4-get-callmebot-api-key"},(0,n.yg)("strong",{parentName:"a"},"Step 4")),"."),(0,n.yg)("h3",{id:"step-4-get-callmebot-api-key"},"Step 4. Get CallMeBot API Key"),(0,n.yg)("p",null,"Once you have your WhatsApp account set up and logged in, now it is time to set up the CallMeBot API. This is the API that will link between Node-RED and WhatsApp."),(0,n.yg)("p",null,"To get your CallMeBot API key, follow these steps (taken from ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/PfisterDaniel/node-red-contrib-whatsapp-cmb/blob/main/README.md#create-api-key"},(0,n.yg)("strong",{parentName:"a"},"this Github repo")),"):"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Add the phone number +34 644 66 32 62 into your Phone Contacts. (Name it it as you wish)"),(0,n.yg)("li",{parentName:"ol"},'Send this message "I allow callmebot to send me messages" to the new Contact created (using WhatsApp of course)'),(0,n.yg)("li",{parentName:"ol"},'Wait until you receive the message "API Activated for your phone number. Your APIKEY is 123123" from the bot. As this is still in beta testing, the activation can take up to 2 minutes.'),(0,n.yg)("li",{parentName:"ol"},"The WhatsApp message from the bot will contain the apikey needed to send messages using the API.")),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/WhatsApp_API.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"There is a possibility that the phone number provided in this tutorial for the CallMeBot API might be full and unable to accept more requests. If this occurs, CallMeBot will send you a WhatsApp message with an alternative phone number to use."),(0,n.yg)("p",{parentName:"admonition"},"In case you do not receive such a message and all provided phone numbers are full, you may need to find an alternative API to link Node-RED to WhatsApp. Make sure to check the latest updates and documentation on the CallMeBot website or explore other WhatsApp messaging APIs compatible with Node-RED."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/WhatsApp_Full.png",style:{width:1e3,height:"auto"}}))),(0,n.yg)("h2",{id:"part-3-integrate-whatsapp-with-node-red"},"Part 3. Integrate WhatsApp with Node-RED"),(0,n.yg)("h3",{id:"step-5-install-whatsapp-module"},"Step 5. Install WhatsApp module"),(0,n.yg)("p",null,"Click the three bars icon and then click ",(0,n.yg)("strong",{parentName:"p"},"Manage palette")," option. This opens a new window where you can add or remove nodes."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_3.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("p",null,"Switch to the ",(0,n.yg)("strong",{parentName:"p"},"Install")," tab within the palette management window. In the search bar, type ",(0,n.yg)("inlineCode",{parentName:"p"},"whatsapp")," to find the module. Then, click the ",(0,n.yg)("strong",{parentName:"p"},"install")," button next to the ",(0,n.yg)("strong",{parentName:"p"},"node-red-contrib-whatsapp-cmb")," entry."),(0,n.yg)("p",null,"We also recommend reviewing the ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/PfisterDaniel/node-red-contrib-whatsapp-cmb/blob/main/README.md"},(0,n.yg)("strong",{parentName:"a"},"node's documentation"))," and the associated ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/PfisterDaniel/node-red-contrib-whatsapp-cmb"},(0,n.yg)("strong",{parentName:"a"},"Github repository"))," if you want a more in-depth understanding of how the module works and how to maximize its potential."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_4.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"The ",(0,n.yg)("strong",{parentName:"p"},"node-red-contrib-whatsapp-cmb")," module is recommended for its current compatibility and reliability at the time of writing this tutorial (July 2024). However, the availability and functionality of Node-RED modules can vary over time. It's advisable to review the most recent user feedback and compatibility notes in the Node-RED library or GitHub repositories. If you encounter issues with this module, consider exploring other WhatsApp modules listed in the Node-RED library for a more suitable option.")),(0,n.yg)("h3",{id:"step-6-configure-whatsapp-node"},"Step 6. Configure WhatsApp node"),(0,n.yg)("p",null,"Once you installed the WhatsApp module, drag the ",(0,n.yg)("strong",{parentName:"p"},"Send Message")," node to your Node-RED flow and connect it to the function node."),(0,n.yg)("p",null,"Double-click the ",(0,n.yg)("strong",{parentName:"p"},"Send Message")," node to configure it. Then, click the plus icon next to the Account field to add a new Account configuration."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_5.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Enter the name you would like to use for this account."),(0,n.yg)("li",{parentName:"ol"},"Enter the phone number associated with your WhatsApp account."),(0,n.yg)("li",{parentName:"ol"},"Enter your API key.")),(0,n.yg)("p",null,"Then, click ",(0,n.yg)("strong",{parentName:"p"},"Add")," or ",(0,n.yg)("strong",{parentName:"p"},"Update")," to save the Account configuration."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_6.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("p",null,"With the account configured, change the dropdown next to the Message field to ",(0,n.yg)("strong",{parentName:"p"},"msg."),", and type ",(0,n.yg)("inlineCode",{parentName:"p"},"payload")," into the text field. Finally, click ",(0,n.yg)("strong",{parentName:"p"},"Done")," to complete the configuration of the WhatsApp node."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_7.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("h3",{id:"step-7-deploy"},"Step 7. Deploy"),(0,n.yg)("p",null,"Finally, deploy your flow by clicking the Deploy button at the top right of the Node-RED interface. This action activates your configured nodes, allowing data to flow from your function node to the CallMeBot API."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_8.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("p",null,"Now, you will receive a notification from WhatsApp whenever your Watcher is triggered."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/WhatsApp_Result.png",style:{width:1e3,height:"auto"}})),(0,n.yg)("h2",{id:"debugging-node-red-errors"},"Debugging: Node-RED Errors"),(0,n.yg)("p",null,"When trying to integrate Node-RED with WhatsApp, it is possible you will encounter an error like this. If this does occur, you can follow these steps to fix it."),(0,n.yg)("div",{style:{textAlign:"center"}},(0,n.yg)("img",{src:"https://files.seeedstudio.com/wiki/Watcher_WhatsApp/Node_RED_Error.png",style:{width:300,height:"auto"}})),(0,n.yg)("p",null,"To resolve this issue, you could try the following steps:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Install the missing ",(0,n.yg)("inlineCode",{parentName:"p"},"aws4")," module by running in your Node-RED user directory:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-sh"},"npm install aws4\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"If that doesn't work, you might need to reinstall the ",(0,n.yg)("inlineCode",{parentName:"p"},"request")," package:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-sh"},"npm install request\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"If the problem persists, you may need to reinstall the WhatsApp node:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-sh"},"npm install node-red-contrib-whatsapp-cmb\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"As a last resort, you could try clearing your npm cache and reinstalling all dependencies:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-sh"}," npm cache clean --force\n npm install\n")))),(0,n.yg)("p",null,"After trying these steps, restart Node-RED and see if the error is resolved. If you're still encountering issues, you may need to check for compatibility between your Node.js version, Node-RED version, and the versions of the packages you're using."),(0,n.yg)("p",null,"Congratulations on successfully integrating Watcher with WhatsApp! You've opened the door to a vast array of exciting opportunities in your development endeavors. Prepare to dive into creating innovative applications that harness the robust capabilities of WhatsApp. We look forward to seeing the remarkable solutions you'll develop next!"),(0,n.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,n.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,n.yg)("div",{class:"button_tech_support_container"},(0,n.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,n.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,n.yg)("div",{class:"button_tech_support_container"},(0,n.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,n.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}c.isMDXComponent=!0}}]);