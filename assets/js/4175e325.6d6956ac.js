"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[55213],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var o=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),u=c(n),d=i,m=u["".concat(l,".").concat(d)]||u[d]||g[d]||s;return n?o.createElement(m,r(r({ref:t},p),{},{components:n})):o.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,r=new Array(s);r[0]=d;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[u]="string"==typeof e?e:i,r[1]=a;for(var c=2;c<s;c++)r[c]=n[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},57819:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>g,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=n(9668),i=(n(96540),n(15680));const s={description:"This article describes how to send the recognition results of a model over MQTT.",title:"Via MQTT output",image:"https://files.seeedstudio.com/wiki/watcher_getting_started/watcherKS.png",slug:"/sensecraft_ai_output_mqtt_xiao",sidebar_position:2,last_update:{date:"12/04/2024",author:"Citric"}},r="Configuring Model Output via MQTT on SenseCraft AI for XIAO ESP32S3 Sense",a={unversionedId:"Cloud_Chain/SenseCraft/SenseCraft_AI/Output/xiao_esp32s3_sense/sensecraft_xiao_esp32s3_mqtt",id:"Cloud_Chain/SenseCraft/SenseCraft_AI/Output/xiao_esp32s3_sense/sensecraft_xiao_esp32s3_mqtt",title:"Via MQTT output",description:"This article describes how to send the recognition results of a model over MQTT.",source:"@site/docs/Cloud_Chain/SenseCraft/SenseCraft_AI/Output/xiao_esp32s3_sense/sensecraft_xiao_esp32s3_mqtt.md",sourceDirName:"Cloud_Chain/SenseCraft/SenseCraft_AI/Output/xiao_esp32s3_sense",slug:"/sensecraft_ai_output_mqtt_xiao",permalink:"/sensecraft_ai_output_mqtt_xiao",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Cloud_Chain/SenseCraft/SenseCraft_AI/Output/xiao_esp32s3_sense/sensecraft_xiao_esp32s3_mqtt.md",tags:[],version:"current",lastUpdatedBy:"Citric",lastUpdatedAt:1733270400,formattedLastUpdatedAt:"Dec 4, 2024",sidebarPosition:2,frontMatter:{description:"This article describes how to send the recognition results of a model over MQTT.",title:"Via MQTT output",image:"https://files.seeedstudio.com/wiki/watcher_getting_started/watcherKS.png",slug:"/sensecraft_ai_output_mqtt_xiao",sidebar_position:2,last_update:{date:"12/04/2024",author:"Citric"}},sidebar:"ProductSidebar",previous:{title:"Via GPIO output",permalink:"/sensecraft_ai_output_gpio_xiao"},next:{title:"As a Sensor",permalink:"/sensecraft_ai_output_libraries_xiao"}},l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1. Access the SenseCraft AI Vision Workspace and connect the XIAO ESP32S3 Sense",id:"step-1-access-the-sensecraft-ai-vision-workspace-and-connect-the-xiao-esp32s3-sense",level:2},{value:"Step 2. Ensure a Model is Loaded on the XIAO ESP32S3 Sense",id:"step-2-ensure-a-model-is-loaded-on-the-xiao-esp32s3-sense",level:2},{value:"Step 3. Configure MQTT Output",id:"step-3-configure-mqtt-output",level:2},{value:"Step 4. Set Up MQTT Configuration",id:"step-4-set-up-mqtt-configuration",level:2},{value:"Step 5. Set Up MQTT Client (MQTTX)",id:"step-5-set-up-mqtt-client-mqttx",level:2},{value:"Step 6. Subscribe to MQTT Topic",id:"step-6-subscribe-to-mqtt-topic",level:2},{value:"Step 7. Send Command to Retrieve Model Inference Results",id:"step-7-send-command-to-retrieve-model-inference-results",level:2},{value:"Conclusion",id:"conclusion",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],p={toc:c},u="wrapper";function g(e){let{components:t,...n}=e;return(0,i.yg)(u,(0,o.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"configuring-model-output-via-mqtt-on-sensecraft-ai-for-xiao-esp32s3-sense"},"Configuring Model Output via MQTT on SenseCraft AI for XIAO ESP32S3 Sense"),(0,i.yg)("p",null,"This wiki article provides a step-by-step guide on how to configure model output using MQTT (Message Queuing Telemetry Transport) for the XIAO ESP32S3 Sense board on the SenseCraft AI platform. MQTT is a lightweight messaging protocol that enables efficient communication between devices. By following these instructions, you will learn how to set up MQTT communication and retrieve model inference results from your XIAO ESP32S3 Sense."),(0,i.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.yg)("p",null,"Before you begin, ensure that you have the following:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"XIAO ESP32S3 Sense board"),(0,i.yg)("li",{parentName:"ol"},"USB-C data cable for connecting the XIAO board to your computer"),(0,i.yg)("li",{parentName:"ol"},"A third-party MQTT client, such as MQTTX, installed on your computer")),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"XIAO ESP32S3 Sense")),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/xiaoesp32s3sense.jpg",style:{width:250,height:"auto"}})))),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/XIAO-ESP32S3-Sense-p-5639.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,i.yg)("h2",{id:"step-1-access-the-sensecraft-ai-vision-workspace-and-connect-the-xiao-esp32s3-sense"},"Step 1. Access the SenseCraft AI Vision Workspace and connect the XIAO ESP32S3 Sense"),(0,i.yg)("p",null,"Open your web browser and navigate to the SenseCraft AI Vision Workspace page."),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://sensecraft.seeed.cc/ai/#/device/local?time=1733300644024"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"},"One-Click Direct \ud83d\uddb1\ufe0f"))))),(0,i.yg)("br",null),(0,i.yg)("p",null,"Select the XIAO ESP32S3 Sense board from the available devices."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/43.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Using the USB-C cable, connect your XIAO ESP32S3 Sense board to your computer. Once connected, click the ",(0,i.yg)("strong",{parentName:"p"},"Connect")," button located in the top-left corner of the SenseCraft AI Vision Workspace page."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/44.png",style:{width:800,height:"auto"}})),(0,i.yg)("h2",{id:"step-2-ensure-a-model-is-loaded-on-the-xiao-esp32s3-sense"},"Step 2. Ensure a Model is Loaded on the XIAO ESP32S3 Sense"),(0,i.yg)("p",null,"Before proceeding, make sure that your XIAO ESP32S3 Sense board has a trained model loaded. If you haven't loaded a model yet, refer to the SenseCraft AI documentation on how to train and deploy models to your device."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/sensecraft_ai_pretrained_models_for_xiao/"},"Using a model for XIAO ESP32S3 Sense"))),(0,i.yg)("p",null,"If you want to use your own trained model, you can refer to the following two Wikis."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/sensecraft_ai_training_classification/"},"Type of training - Classification")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/sensecraft_ai_training_object_detection/"},"Type of training - Object Detection"))),(0,i.yg)("h2",{id:"step-3-configure-mqtt-output"},"Step 3. Configure MQTT Output"),(0,i.yg)("p",null,"In the left sidebar of the Vision Workspace page, click on the ",(0,i.yg)("strong",{parentName:"p"},"Output")," option. From the available output options, select ",(0,i.yg)("strong",{parentName:"p"},"MQTT")," to access the MQTT configuration settings."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/56.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h2",{id:"step-4-set-up-mqtt-configuration"},"Step 4. Set Up MQTT Configuration"),(0,i.yg)("p",null,"Click on the ",(0,i.yg)("strong",{parentName:"p"},"Configuration")," button at the bottom of the MQTT output section. A configuration window will appear, prompting you to enter the following information:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"SSID"),": Enter the name of your Wi-Fi network."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Password"),": Provide the password for your Wi-Fi network."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Encryption"),": Choose the encryption type for your Wi-Fi network (e.g., AUTO)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"MQTT"),': Select "Yes" to enable MQTT communication.')),(0,i.yg)("p",null,"Fill in the MQTT configuration fields:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Host"),": Enter the hostname or IP address of your MQTT broker (e.g., broker.emqx.io)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Port"),": Specify the port number for MQTT communication (e.g., 1883)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Client ID"),": Provide a unique client ID for your XIAO ESP32S3 Sense (e.g., xiao_esp32s3)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"User Name"),": Enter your MQTT username, if required by your MQTT broker."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Password"),": Provide your MQTT password, if required by your MQTT broker."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"SSL"),': Choose whether to enable SSL encryption. If your MQTT broker supports SSL, you can select "Yes" to enhance communication security.')),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/57.png",style:{width:700,height:"auto"}})),(0,i.yg)("p",null,"Click the ",(0,i.yg)("strong",{parentName:"p"},"Apply")," button to save the configuration."),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"This step will require a network connection, please connect an antenna for XIAO ESP32S3 Sense.")),(0,i.yg)("p",null,"If everything is configured smoothly, you should be able to see the following information on the website."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/60.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h2",{id:"step-5-set-up-mqtt-client-mqttx"},"Step 5. Set Up MQTT Client (MQTTX)"),(0,i.yg)("p",null,"Launch the ",(0,i.yg)("a",{parentName:"p",href:"https://mqttx.app/"},"MQTTX application")," on your computer."),(0,i.yg)("p",null,"Create a new connection with the following settings:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Host: Enter the same hostname or IP address used in the SenseCraft AI platform (e.g., broker.emqx.io)."),(0,i.yg)("li",{parentName:"ul"},"Port: Specify the port number for MQTT communication (e.g., 1883)."),(0,i.yg)("li",{parentName:"ul"},"Client ID: Provide a unique client ID for your MQTTX instance (e.g., seeed_computer).")),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/58.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Click the ",(0,i.yg)("strong",{parentName:"p"},"Connect")," button to establish a connection with the MQTT broker."),(0,i.yg)("h2",{id:"step-6-subscribe-to-mqtt-topic"},"Step 6. Subscribe to MQTT Topic"),(0,i.yg)("p",null,"In the MQTTX application, click on the ",(0,i.yg)("strong",{parentName:"p"},"New Subscribe")," button to create a new subscription. Enter the topic ",(0,i.yg)("inlineCode",{parentName:"p"},"sscma/v0/#")," and click ",(0,i.yg)("strong",{parentName:"p"},"Subscribe"),"."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/59.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"This topic will be used to receive model inference information from your XIAO ESP32S3 Sense."),(0,i.yg)("h2",{id:"step-7-send-command-to-retrieve-model-inference-results"},"Step 7. Send Command to Retrieve Model Inference Results"),(0,i.yg)("p",null,"In the MQTTX application, navigate to the device topic channel. You can get it by clicking the ",(0,i.yg)("strong",{parentName:"p"},"Query device's topic")," button on SenseCraft AI's MQTT page."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/61.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Send the command ",(0,i.yg)("inlineCode",{parentName:"p"},"AT+INVOKE=-1,0")," to trigger the model inference on your XIAO ESP32S3 Sense."),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"Please make sure you are sending the correct topic."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/62.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",{parentName:"admonition"},"If you find that you still don't have any model recognition related data to report, try sending the command in HEX format."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/65.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/66.png",style:{width:1e3,height:"auto"}}))),(0,i.yg)("p",null,"The XIAO ESP32S3 Sense will process the command and publish the model inference results to the subscribed topic. In the MQTTX application, you will receive the inference results under the ",(0,i.yg)("inlineCode",{parentName:"p"},"sscma/v0/#")," topic."),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Example"),":"),(0,i.yg)("p",null,"Let's say your trained model is designed to detect objects in an image. When you send the 'AT+INVOKE=-1,0' command, the XIAO ESP32S3 Sense will capture an image, run the model inference, and publish the results via MQTT. The inference results may include information such as the detected objects, their bounding boxes, and confidence scores. For instance, the MQTT message payload could be:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{"type":1,"name":"INVOKE","code":0,"data":{"count":989,"image":"/9j/4AAQSkZJRgABAQEAAAAAAAD...CUxBQAYoAPpQAc0AA/9X/2Q==","boxes":[[208.46,215.41,69.49,48.64,80.60,0]],"perf":[70,470,0],"rotation":0,"width":240,"height":240}}\n')),(0,i.yg)("p",null,"For a detailed description of the JSON format read the documentation ",(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"https://github.com/Seeed-Studio/SSCMA-Micro/blob/main/docs/protocol/at-protocol-en_US.md#box-type"},"here")),"."),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"In the device's firmware, there is a set of established communication protocols that specify the format of the model results output, and what the user can do with the models. Due to space issues, we won't be expanding on the specifics of these protocols in this wiki, we'll be detailing this section through documentation on Github. If you are interested in more in-depth development, please go ",(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"https://github.com/Seeed-Studio/SSCMA-Micro/blob/dev/docs/protocol/at_protocol.md"},"here")),".")),(0,i.yg)("p",null,"To decode the base64-encoded image:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},'Copy the base64-encoded string from the "image" field in the JSON object.')),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Visit the website ",(0,i.yg)("inlineCode",{parentName:"p"},"https://base64.guru/converter/decode/image")," in your web browser.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},'Paste the copied base64-encoded string into the "Base64 string" textarea on the website.')),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Click the ",(0,i.yg)("strong",{parentName:"p"},"Decode Base64 to Image")," button.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"The decoded image will appear below the button, and you can view or download it."))),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SenseCraft_AI/img2/64.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h2",{id:"conclusion"},"Conclusion"),(0,i.yg)("p",null,"By following this step-by-step guide, you have learned how to configure model output using MQTT on the SenseCraft AI platform for the XIAO ESP32S3 Sense board. You can now retrieve model inference results via MQTT and integrate them into your applications or systems. Remember to ensure a stable Wi-Fi connection and correctly configure your MQTT broker and client settings for seamless communication."),(0,i.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,i.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://discord.com/invite/QqMgVwHT3X",class:"button_tech_support_sensecap"}),(0,i.yg)("a",{href:"https://support.sensecapmx.com/portal/en/home",class:"button_tech_support_sensecap3"})),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"mailto:support@sensecapmx.com",class:"button_tech_support_sensecap2"}),(0,i.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}g.isMDXComponent=!0}}]);