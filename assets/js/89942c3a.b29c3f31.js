"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[41972],{15680:(e,t,n)=>{n.d(t,{xA:()=>g,yg:()=>m});var a=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},g=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,g=s(e,["components","mdxType","originalType","parentName"]),d=p(n),c=i,m=d["".concat(l,".").concat(c)]||d[c]||u[c]||r;return n?a.createElement(m,o(o({ref:t},g),{},{components:n})):a.createElement(m,o({ref:t},g))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},87568:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=n(9668),i=(n(96540),n(15680));const r={description:"User will learn how to integrate Watcher with the Grove system, enabling them to expand its capabilities and connect with a wide range of sensors and peripherals.",title:"As a sensor & Use Grove",image:"https://files.seeedstudio.com/wiki/watcher_getting_started/64.jpg",slug:"/watcher_as_grove",sidebar_position:5,last_update:{date:"07/10/2024",author:"Citric"}},o="As a sensor & Use Grove",s={unversionedId:"Sensor/SenseCAP/SenseCAP_Watcher/Product_Overview/sensecap_watcher_as_grove",id:"Sensor/SenseCAP/SenseCAP_Watcher/Product_Overview/sensecap_watcher_as_grove",title:"As a sensor & Use Grove",description:"User will learn how to integrate Watcher with the Grove system, enabling them to expand its capabilities and connect with a wide range of sensors and peripherals.",source:"@site/docs/Sensor/SenseCAP/SenseCAP_Watcher/Product_Overview/sensecap_watcher_as_grove.md",sourceDirName:"Sensor/SenseCAP/SenseCAP_Watcher/Product_Overview",slug:"/watcher_as_grove",permalink:"/watcher_as_grove",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/SenseCAP/SenseCAP_Watcher/Product_Overview/sensecap_watcher_as_grove.md",tags:[],version:"current",lastUpdatedBy:"Citric",lastUpdatedAt:1720569600,formattedLastUpdatedAt:"Jul 10, 2024",sidebarPosition:5,frontMatter:{description:"User will learn how to integrate Watcher with the Grove system, enabling them to expand its capabilities and connect with a wide range of sensors and peripherals.",title:"As a sensor & Use Grove",image:"https://files.seeedstudio.com/wiki/watcher_getting_started/64.jpg",slug:"/watcher_as_grove",sidebar_position:5,last_update:{date:"07/10/2024",author:"Citric"}},sidebar:"ProductSidebar",previous:{title:"SenseCraft APP Guideline",permalink:"/getting_started_with_watcher_look_tool"},next:{title:"Software Framework Overview",permalink:"/watcher_software_framework_overview"}},l={},p=[{value:"Watcher UART wiring",id:"watcher-uart-wiring",level:2},{value:"Enabling UART Functionality in Watcher",id:"enabling-uart-functionality-in-watcher",level:2},{value:"Reading UART Output from Watcher",id:"reading-uart-output-from-watcher",level:2},{value:"Output Format",id:"output-format",level:3},{value:"Binary Output Format",id:"binary-output-format",level:3},{value:"JSON Output Format",id:"json-output-format",level:3},{value:"Configuration Options",id:"configuration-options",level:3},{value:"XIAO ESP32 Series &amp; Watcher",id:"xiao-esp32-series--watcher",level:2},{value:"Wiring",id:"wiring",level:3},{value:"Code Explanation",id:"code-explanation",level:3},{value:"Uploading the Code to XIAO ESP32 Series",id:"uploading-the-code-to-xiao-esp32-series",level:3},{value:"Expected Results",id:"expected-results",level:3},{value:"Raspberry Pi &amp; Watcher",id:"raspberry-pi--watcher",level:2},{value:"Wiring",id:"wiring-1",level:3},{value:"Code Explanation",id:"code-explanation-1",level:3},{value:"Running the Code to Raspberry Pi",id:"running-the-code-to-raspberry-pi",level:3},{value:"Expected Results",id:"expected-results-1",level:3},{value:"reComputer Jetson &amp; Watch",id:"recomputer-jetson--watch",level:2},{value:"Wiring",id:"wiring-2",level:3},{value:"Code Explanation",id:"code-explanation-2",level:3},{value:"Uploading the Code to reComputer",id:"uploading-the-code-to-recomputer",level:3},{value:"Expected Results",id:"expected-results-2",level:3},{value:"Resources",id:"resources",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],g={toc:p},d="wrapper";function u(e){let{components:t,...n}=e;return(0,i.yg)(d,(0,a.A)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"as-a-sensor--use-grove"},"As a sensor & Use Grove"),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/64.jpg",style:{width:800,height:"auto"}})),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/SenseCAP-Watcher-W1-A-p-5979.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now"))))),(0,i.yg)("br",null),(0,i.yg)("p",null,"In this wiki, we will explore the exciting possibilities that arise when Watcher, acting as a sensor, leverages its UART (Universal Asynchronous Receiver/Transmitter) functionality. By enabling UART communication, Watcher can transmit valuable data such as captured images and recognition results through its UART interface, located on the back of the device. This opens up a world of opportunities for integrating Watcher with various hardware platforms and creating innovative applications."),(0,i.yg)("p",null,"Throughout this wiki, we will dive into the details of reading and interpreting the data output from Watcher's UART interface. Additionally, we will provide comprehensive tutorials on how to parse and utilize this data using popular development boards and platforms, including XIAO, Arduino, Raspberry Pi, and Jetson."),(0,i.yg)("h2",{id:"watcher-uart-wiring"},"Watcher UART wiring"),(0,i.yg)("p",null,"When you are ready to use the UART for message alarms, please connect the Watcher to your MCU as follows."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/58.png",style:{width:800,height:"auto"}})),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Note that if your Watcher and MCU are powered separately, then you ",(0,i.yg)("strong",{parentName:"p"},"do not need to")," connect the ",(0,i.yg)("strong",{parentName:"p"},"3.3V or 5V")," pins of the Watcher and MCU."),(0,i.yg)("p",{parentName:"admonition"},"If you are planning to use the Watcher to power the MCU, then you can use ",(0,i.yg)("strong",{parentName:"p"},"3.3V")," to power the MCU on top of the wiring in the picture. (Do not use the 5V pins, they are for input only)"),(0,i.yg)("p",{parentName:"admonition"},"If you are planning to use the MCU to power the Watcher, then you can need to use the ",(0,i.yg)("strong",{parentName:"p"},"5V")," input. (3.3V may not be enough for the Watcher to work properly)")),(0,i.yg)("h2",{id:"enabling-uart-functionality-in-watcher"},"Enabling UART Functionality in Watcher"),(0,i.yg)("p",null,"To unlock the full potential of Watcher's UART capabilities, we first need to enable the UART functionality within the device. This is particularly useful in scenarios where Watcher is employed as an alarm system. When an alarm is triggered, Watcher can activate its UART communication, allowing it to transmit critical information such as captured images and recognition results to external devices for further processing and analysis."),(0,i.yg)("p",null,"To enable the UART alarm function, you have two options:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Explicitly request Watcher to notify you via UART when assigning tasks using the SenseCraft APP.")),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/60.png",style:{width:250,height:"auto"}})),(0,i.yg)("ol",{start:2},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Manually enable the UART alarm function in the task's detailed settings:"),(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"Access the ",(0,i.yg)("strong",{parentName:"li"},"Detail Config")," of the task you want to configure."),(0,i.yg)("li",{parentName:"ul"},"Locate the ",(0,i.yg)("strong",{parentName:"li"},"Action")," section."),(0,i.yg)("li",{parentName:"ul"},"Check the box to enable the ",(0,i.yg)("strong",{parentName:"li"},"Serial Port / UART Output"),".")))),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/86.png",style:{width:250,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"Please choose whether you need to enable the output of images according to your actual application scenario. If ",(0,i.yg)("strong",{parentName:"p"},"Include base64 image")," is enabled, then your MCU needs ",(0,i.yg)("strong",{parentName:"p"},"at least 70k memory")," to cache the image.")),(0,i.yg)("p",null,"Once you have enabled the UART alarm function using either of the above methods, Watcher will output the necessary alarm information via UART whenever it detects the specified alarm content. Ensure that Watcher is connected to the appropriate receiving device, such as a microcontroller or a computer with a serial terminal, to capture and process the alarm information transmitted through UART."),(0,i.yg)("h2",{id:"reading-uart-output-from-watcher"},"Reading UART Output from Watcher"),(0,i.yg)("p",null,"Once UART functionality is enabled, Watcher will begin transmitting data through its UART interface. In this section, we will provide a detailed guide on how to read and interpret the data received from Watcher's UART output. We will cover the necessary hardware connections, communication protocols, and data formats to ensure a smooth and successful data retrieval process."),(0,i.yg)("p",null,"By default, Watcher uses the following UART configuration: baud rate of ",(0,i.yg)("strong",{parentName:"p"},"115200"),", ",(0,i.yg)("strong",{parentName:"p"},"8 data bits"),", ",(0,i.yg)("strong",{parentName:"p"},"no parity"),", ",(0,i.yg)("strong",{parentName:"p"},"1 stop bit"),", and ",(0,i.yg)("strong",{parentName:"p"},"no hardware flow control"),". When connecting to Watcher's UART interface, ensure that your receiving device is configured with the same settings to ensure proper communication."),(0,i.yg)("p",null,"When Watcher sends alarm information via UART, it follows a specific protocol and format based on the ",(0,i.yg)("inlineCode",{parentName:"p"},"tf_module_uart_alarm_t")," structure defined in the ",(0,i.yg)("inlineCode",{parentName:"p"},"tf_module_uart_alarm.h")," header file. The UART protocol and format for Watcher's UART alarm module are as follows:"),(0,i.yg)("h3",{id:"output-format"},"Output Format"),(0,i.yg)("p",null,"The format of the UART output is controlled by the ",(0,i.yg)("inlineCode",{parentName:"p"},"output_format")," field."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"When ",(0,i.yg)("inlineCode",{parentName:"li"},"output_format")," is set to 0, the output is in binary format."),(0,i.yg)("li",{parentName:"ul"},"When ",(0,i.yg)("inlineCode",{parentName:"li"},"output_format")," is set to 1, the output is in JSON format.")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},(0,i.yg)("inlineCode",{parentName:"p"},"output_format")," is set to 1 by default to output in JSON.")),(0,i.yg)("h3",{id:"binary-output-format"},"Binary Output Format"),(0,i.yg)("p",null,"When ",(0,i.yg)("inlineCode",{parentName:"p"},"output_format")," is set to 0, the structure of the UART output packet is as follows:"),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/api.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"PKT_MAGIC_HEADER"),': The magic header of the packet, fixed as "SEEED" (5 bytes).'),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Prompt Str Len"),": The length of the prompt string, 4-byte unsigned integer in little-endian."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Prompt Str"),": The prompt string, used to briefly explain the task that Watcher is performing. If the ",(0,i.yg)("inlineCode",{parentName:"li"},"text")," parameter is set, its value is used."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Big Image Len"),": The length of the big image, 4-byte unsigned integer in little-endian. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_big_image")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Big Image"),": 640*480 JPG image, base64 encoded, without boxes of detected objects. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_big_image")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Small Image Len"),": The length of the small image, 4-byte unsigned integer in little-endian. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_small_image")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Small Image"),": 240*240 JPG image, base64 encoded, with boxes drawn for detected objects. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_small_image")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Boxes Count"),": The number of detected object boxes, 4-byte unsigned integer in little-endian. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_boxes")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"Box Structure"),": The structure of a detected object box, each box occupies 10 bytes, including coordinates, score, and target class ID. Only included when ",(0,i.yg)("inlineCode",{parentName:"li"},"include_boxes")," is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),".")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The recognised boxes (boxes) message will not be received at this time, as the corresponding feature of Watcher is still under development and has not yet been reported in the latest v1.1 release.")),(0,i.yg)("h3",{id:"json-output-format"},"JSON Output Format"),(0,i.yg)("p",null,"When ",(0,i.yg)("inlineCode",{parentName:"p"},"output_format")," is set to 1, the structure of the UART output packet is as follows:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n      "prompt": "People detected",\n      "big_image": "base64 encoded JPG image, if include_big_image is enabled, otherwise this field is omitted",\n      "inference":{\n        "boxes": [\n            {\n                "x": 100,\n                "y": 100,\n                "w": 50,\n                "h": 60,\n                "score": 0.8,\n                "target_cls_id": 1\n            }\n        ],\n        "classes_name": ["person"]\n      },\n\n}\n')),(0,i.yg)("p",null,"Among them, ",(0,i.yg)("strong",{parentName:"p"},"(x,y)")," is the center point position of the recognized object, and ",(0,i.yg)("strong",{parentName:"p"},"(w,h)")," is the height and width of the recognition box, as shown in the figure below. ",(0,i.yg)("strong",{parentName:"p"},"score")," is confidence level, ",(0,i.yg)("strong",{parentName:"p"},"target_cls_id")," is recognized object id."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/xyhw.png",style:{width:400,height:"auto"}})),(0,i.yg)("h3",{id:"configuration-options"},"Configuration Options"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"output_format"),": Controls the format of the UART output, default is 1 (JSON format)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"text"),": Used to fill the ",(0,i.yg)("inlineCode",{parentName:"li"},"prompt")," field of the output packet."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"include_big_image"),": Boolean (true | false), controls whether the big image is included in the output, default is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"include_boxes"),": Boolean (true | false), controls whether the boxes are included in the output, default is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),".")),(0,i.yg)("p",null,"Note: If any configuration field is omitted, the default value will be implied."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The recognised boxes (boxes) message will not be received at this time, as the corresponding feature of Watcher is still under development and has not yet been reported in the latest v1.1 release.")),(0,i.yg)("h2",{id:"xiao-esp32-series--watcher"},"XIAO ESP32 Series & Watcher"),(0,i.yg)("p",null,"Learn how to connect Watcher to the XIAO ESP32 Series board and parse the UART data using the Arduino. This section will guide you on how to connect Watcher to the XIAO ESP32 Series board and parse the UART data using Arduino."),(0,i.yg)("h3",{id:"wiring"},"Wiring"),(0,i.yg)("p",null,"This tutorial supports the series XIAO:"),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"XIAO ESP32C3"),(0,i.yg)("th",null,"XIAO ESP32S3"),(0,i.yg)("th",null,"XIAO ESP32C6")),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/XIAO_WiFi/board-pic.png",style:{width:110,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/xiaoesp32s3.jpg",style:{width:250,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32C6/img/xiaoc6.jpg",style:{width:250,height:"auto"}})))),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-XIAO-ESP32C3-p-5431.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/XIAO-ESP32S3-p-5627.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-Studio-XIAO-ESP32C6-p-5884.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"This does not mean that other XIAO series are not supported. Mainly because the message data reported by Watcher takes up about ",(0,i.yg)("strong",{parentName:"p"},"100k")," (at least 70k) of memory, we would recommend you to use the ESP32 series of XIAO for the UART part of the Watcher development. If you don't need to parse image data, then the other XIAO's memory is perfectly adequate.")),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/63.png",style:{width:700,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the TX pin of the Watcher to the RX pin of the XIAO's UART interface.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the RX pin of the Watcher to the TX pin of the XIAO's UART interface.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the GND pin of the Watcher to a GND pin on the XIAO."))),(0,i.yg)("h3",{id:"code-explanation"},"Code Explanation"),(0,i.yg)("p",null,"You can use any XIAO ESP32 series development board, or any other ESP32 series board to use the following program to read the UART data stream of the Watcher."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Currently, only JSON data streams can be output, so only programs that parse JSON data streams are provided."),(0,i.yg)("p",{parentName:"admonition"},"Other XIAOs are not always supported, mainly because parsing a JSON stream requires at least 70k of memory.")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'#include <ArduinoJson.h>\n\nlong int count = 0;  // Number of alarms\n\nvoid setup() {\n  Serial.begin(115200);\n  Serial1.begin(115200, SERIAL_8N1, D7, D6);  // RX, TX\n  while(!Serial);\n  delay(100);\n\n  Serial.println("Device Ready. Waiting for Watcher\'s JSON data...");\n}\n\nvoid loop() {\n  if (Serial1.available()) {\n    // Set up enough space to store the parsed JSON objects\n    const size_t capacity = 1024 * 100 + 512; // At least 70k, insurance 100k\n    DynamicJsonDocument doc(capacity);\n\n    // Streaming parsing from Serial1\n    DeserializationError error = deserializeJson(doc, Serial1);\n\n    if (error) {\n      Serial.print("deserializeJson() failed: ");\n      Serial.println(error.c_str());\n      return;\n    }\n\n    // Print the parsed key-value pairs\n    if (doc.containsKey("prompt")) {\n      Serial.print("prompt: ");\n      Serial.println(doc["prompt"].as<String>());\n    }\n\n    if (doc.containsKey("inference")) {\n      Serial.print("inference: ");\n      Serial.println(doc["inference"].as<String>());\n    }\n\n   if (doc.containsKey("inference")) {\n     JsonArray boxes = doc["inference"]["boxes"][0].as<JsonArray>();\n      Serial.println();\n      Serial.println("You can get the number inside the boxes.");\n      Serial.print("Box -> ");\n      Serial.print("x: ");\n      Serial.print(boxes[0].as<int>());\n      Serial.print(", y: ");\n      Serial.print(boxes[1].as<int>());\n      Serial.print(", widths: ");\n      Serial.print(boxes[2].as<int>());\n      Serial.print(", height: ");\n      Serial.print(boxes[3].as<int>());\n      Serial.print(", score: ");\n      Serial.print(boxes[4].as<int>());\n      Serial.print(", target_cls_id: ");\n      Serial.println(boxes[5].as<int>());\n   }\n    \n    // You need to turn on "Inculde base64 iamge" button in your app, default is off.\n    //And then, uncomment the following code.\n    /*\n    if (doc.containsKey("big_image")) {\n      Serial.print("big_image: ");\n      String big_imageData = doc["big_image"].as<String>();\n      // Print only the first 100 characters of the image data for example\n      Serial.println(big_imageData.substring(0, 100) + "...");\n    }\n    */\n\n\n    count++;\n    if(count > 2147483646){  // Spillage prevention\n      count = 0;\n    }\n    Serial.print("The ");\n    Serial.print(count);\n    Serial.println(" alarm message reception is complete. Wait for the next message...");\n    Serial.println("------------------------------------------------------------------");\n  }\n}\n')),(0,i.yg)("p",null,"The provided code demonstrates how to receive and parse JSON data from Watcher using the Arduino IDE and the ArduinoJson library. Here's a brief explanation of the code:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"The necessary library, ",(0,i.yg)("strong",{parentName:"li"},"ArduinoJson"),", is included to handle JSON parsing. You can search for and install it in Arduino's library manager.")),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://github.com/bblanchon/ArduinoJson"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"},"Go To Github \ud83d\uddb1\ufe0f"))))),(0,i.yg)("ol",{start:2},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"In the ",(0,i.yg)("inlineCode",{parentName:"p"},"setup()")," function, the serial communication is initialized for both the USB serial (for debugging) and the UART serial (for receiving data from Watcher).")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"In the ",(0,i.yg)("inlineCode",{parentName:"p"},"loop()")," function, the code checks if there is available data on the UART serial.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"If data is available, a ",(0,i.yg)("inlineCode",{parentName:"p"},"DynamicJsonDocument")," is created with a specified capacity to store the parsed JSON objects.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"The JSON data is parsed using the ",(0,i.yg)("inlineCode",{parentName:"p"},"deserializeJson()")," function, and any parsing errors are handled.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},'The code then checks for the presence of specific keys in the parsed JSON object, such as "prompt", "big_image", and "small_image".'))),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The parsing of information about recognised boxes (boxes) is not available at the moment, because the corresponding function of Watcher is still under development, and this information is not yet reported in the latest v1.0.1 version.")),(0,i.yg)("ol",{start:7},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"If a key is found, its corresponding value is printed to the USB serial for debugging purposes.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"The code also keeps track of the number of received alarm messages using the ",(0,i.yg)("inlineCode",{parentName:"p"},"count")," variable.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Finally, a message is printed to indicate the completion of each alarm message reception, and the code waits for the next message."))),(0,i.yg)("h3",{id:"uploading-the-code-to-xiao-esp32-series"},"Uploading the Code to XIAO ESP32 Series"),(0,i.yg)("p",null,"To upload the code to your XIAO ESP32 Series board, follow these steps:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Connect your XIAO ESP32 Series board to your computer using a USB cable.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Open the Arduino IDE and ensure that you have the necessary board support package installed for the XIAO ESP32 Series."),(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"If you want to use ",(0,i.yg)("strong",{parentName:"p"},"Seeed Studio XIAO ESP32C3")," for the routines, please refer to ",(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"https://wiki.seeedstudio.com/XIAO_ESP32C3_Getting_Started#software-setup"},"this tutorial"))," to finish adding.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"If you want to use ",(0,i.yg)("strong",{parentName:"p"},"Seeed Studio XIAO ESP32S3")," for the routines, please refer to ",(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"http://wiki.seeedstudio.com/xiao_esp32s3_getting_started#software-preparation"},"this tutorial"))," to finish adding.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"If you want to use ",(0,i.yg)("strong",{parentName:"p"},"Seeed Studio XIAO ESP32C6")," for the routines, please refer to ",(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"https://wiki.seeedstudio.com/xiao_esp32c6_getting_started/"},"this tutorial"))," to finish adding.")))),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Select the appropriate board and port from the Tools menu in the Arduino IDE.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Open the provided code in the Arduino IDE.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Click the ",(0,i.yg)("strong",{parentName:"p"},"Upload")," button to compile and upload the code to your XIAO ESP32 Series board."))),(0,i.yg)("h3",{id:"expected-results"},"Expected Results"),(0,i.yg)("p",null,"Once the code is uploaded and running on your XIAO ESP32 Series board, after Watcher identifies the target alarm, you should see the following behavior:"),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/62.png",style:{width:800,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("p",null,"You can also try using another Arduino development board, but make sure it has enough memory."),(0,i.yg)("h2",{id:"raspberry-pi--watcher"},"Raspberry Pi & Watcher"),(0,i.yg)("p",null,"Explore the process of connecting Watcher to a Raspberry Pi and utilizing Python scripts to parse and analyze the UART data."),(0,i.yg)("h3",{id:"wiring-1"},"Wiring"),(0,i.yg)("p",null,"This section will explain the Raspberry Pi 5 as an example, if you need it, you can place an order for it through the link below."),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Raspberry-Pi-5-8GB-p-5810.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Buy Raspberry Pi \ud83d\uddb1\ufe0f"))))),(0,i.yg)("p",null,"If you are using another Raspberry Pi series, the code and tutorials on how to use it are essentially the same."),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/65.png",style:{width:800,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the TX pin of the Watcher to the RX pin (GPIO 15) of the Raspberry Pi.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the RX pin of the Watcher to the TX pin (GPIO 14) of the Raspberry Pi.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the GND pin of the Watcher to a GND pin on the Raspberry Pi."))),(0,i.yg)("h3",{id:"code-explanation-1"},"Code Explanation"),(0,i.yg)("p",null,"Before running the Python scripts, make sure to install the required dependencies:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"sudo apt update\nsudo apt install python3-pip\npip3 install pyserial pillow\n")),(0,i.yg)("p",null,"Check the device name of the UART interface on the Raspberry Pi:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"ls /dev/ttyAMA*\n")),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/67.png",style:{width:700,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("p",null,"The first Python script reads the JSON data from the Watcher over UART and prints it:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},'import serial\n\n# Set up the serial port\nser = serial.Serial(\'/dev/ttyAMA0\', 115200, timeout=1) \n\ndef read_json_from_serial():\n    while True:\n        if ser.in_waiting > 0:\n            data = ser.readline()\n            print(data.decode().strip())\n\nif __name__ == "__main__":\n    print("Starting serial JSON reader on Raspberry Pi...")\n    read_json_from_serial()\n')),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/68.png",style:{width:900,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("ol",{parentName:"admonition"},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"My UART interface corresponds to ",(0,i.yg)("inlineCode",{parentName:"p"},"/dev/ttyAMA0"),", if yours doesn't, please modify it yourself.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"This is a test script that you can use to check if the Raspberry Pi/Watcher's UART is working properly.")))),(0,i.yg)("p",null,"The second Python script builds upon the first one and adds JSON parsing and saving of image data:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"import json\nimport serial  \nimport base64\nfrom PIL import Image\nimport io\n\n# Set up the serial port\nser = serial.Serial('/dev/ttyAMA0', 115200, timeout=1)\n\n# Initialize image counters\nbig_image_counter = 1\nsmall_image_counter = 1\n\ndef read_json_from_serial(): \n    buffer = \"\"\n    try:\n        while True:\n            if ser.in_waiting > 0:\n                data = ser.read(ser.in_waiting).decode()  \n                buffer += data\n\n                if '}' in buffer:\n                    end = buffer.rfind('}')\n                    json_data = buffer[:end+1]\n                    buffer = buffer[end+1:]\n\n                    try:  \n                        data = json.loads(json_data)\n                        print(\"Received JSON data, processing...\")\n                        process_json_data(data)\n                    except json.JSONDecodeError:\n                        print(\"Error decoding JSON\")  \n                        buffer = json_data + buffer\n    except Exception as e:\n        print(f\"An error occurred: {e}\")\n\ndef process_json_data(data):\n    global big_image_counter, small_image_counter  # Declare global variables\n\n    # Process prompt info\n    if \"prompt\" in data:  \n        print(f\"Prompt: {data['prompt']}\")\n    \n    # Process boxes info\n    #if \"boxes\" in data:\n        #for index, box in enumerate(data['boxes']):\n            #print(f\"Box {index + 1} - x: {box['x']}, y: {box['y']}, w: {box['w']}, h: {box['h']}, score: {box['score']}, target_cls_id: {box['target_cls_id']}\")\n\n    if \"big_image\" in data:  \n        filename = f'big_image_{big_image_counter}.png'\n        decode_and_save_image(data['big_image'], filename) \n        print(f\"Big image processed and saved as {filename}.\")\n        big_image_counter += 1  # Update global variable \n\n    if \"small_image\" in data:\n        filename = f'small_image_{small_image_counter}.png' \n        decode_and_save_image(data['small_image'], filename)\n        print(f\"Small image processed and saved as {filename}.\")  \n        small_image_counter += 1  # Update global variable\n\ndef decode_and_save_image(base64_data, filename):\n    image_bytes = base64.b64decode(base64_data)\n    image = Image.open(io.BytesIO(image_bytes))\n    image.save(filename)  # Save as PNG file\n    return image\n\nif __name__ == \"__main__\": \n    print(\"Starting serial JSON reader on Raspberry Pi...\")\n    read_json_from_serial()\n")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Currently, only JSON data streams can be output, so only programs that parse JSON data streams are provided.")),(0,i.yg)("p",null,"This script does the following:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Reads JSON data from UART in a loop")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Decodes the JSON data and calls ",(0,i.yg)("inlineCode",{parentName:"p"},"process_json_data")," to handle it")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Extracts prompt info and image data from the JSON"))),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The parsing of information about recognised boxes (boxes) is not available at the moment, because the corresponding function of Watcher is still under development, and this information is not yet reported in the latest v1.0.1 version.")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Decodes the base64 encoded image data and saves as PNG files using ",(0,i.yg)("inlineCode",{parentName:"p"},"decode_and_save_image"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Prints the extracted info and filenames of saved images"))),(0,i.yg)("h3",{id:"running-the-code-to-raspberry-pi"},"Running the Code to Raspberry Pi"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Create a new Python file on the Raspberry Pi, e.g. watcher_uart.py:")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"nano watcher_uart.py\n")),(0,i.yg)("ol",{start:2},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Copy and paste the complete Python code into the file.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Press Ctrl+X, then Y and Enter to save and exit the editor.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"Run the Python script:"))),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"python watcher_uart.py\n")),(0,i.yg)("h3",{id:"expected-results-1"},"Expected Results"),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/69.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("p",null,"After running the script:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"The parsed JSON data received from the Watcher will be printed in the terminal in real-time.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"The received big image and small image will be automatically saved as big_image_x.png and small_image_x.png files."))),(0,i.yg)("p",null,"That's it! You have now learned how to connect the Watcher to a Raspberry Pi, read the UART data with Python, parse the JSON, and save the transmitted images. Feel free to experiment further, such as trying to display the received data on a screen connected to the Raspberry Pi in real-time."),(0,i.yg)("h2",{id:"recomputer-jetson--watch"},"reComputer Jetson & Watch"),(0,i.yg)("p",null,"Explore the process of connecting Watcher to a reComputer (an NVIDIA Jetson-based device) and utilizing Python scripts to parse and analyze the UART data."),(0,i.yg)("h3",{id:"wiring-2"},"Wiring"),(0,i.yg)("p",null,"This tutorial will explain the J401 reComputer carrier board suitable for developers as an example, and if you want to buy the reComputer, you can pick it up at the link below."),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/reComputer-J4012-w-o-power-adapter-p-5628.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Buy reComputer \ud83d\uddb1\ufe0f"))))),(0,i.yg)("p",null,"In theory, the content and code in this section applies to all NVIDIA Jetson series products."),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/66.png",style:{width:800,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the TX pin of the Watcher to the RX pin of the reComputer's UART interface.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the RX pin of the Watcher to the TX pin of the reComputer's UART interface.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Connect the GND pin of the Watcher to a GND pin on the reComputer."))),(0,i.yg)("h3",{id:"code-explanation-2"},"Code Explanation"),(0,i.yg)("p",null,"Before running the Python scripts, make sure to install the required dependencies:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"sudo apt-get update\nsudo apt-get install python3-serial\nsudo apt-get install python3-pillow\n")),(0,i.yg)("p",null,"If you do not intend to use the Serial Console on the UART, you should disable the Serial Console:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"systemctl stop nvgetty\nsystemctl disable nvgetty\nudevadm trigger\n")),(0,i.yg)("p",null,"You may need to reboot your reComputer at this point for the changes to take effect."),(0,i.yg)("p",null,"Check the device name of the UART interface on the reComputer:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"ls /dev/ttyTHS*\n")),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/71.png",style:{width:700,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("p",null,"The first Python script reads the JSON data from the Watcher over UART and prints it:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},'import serial\n\n# Set up the serial port\nser = serial.Serial(\'/dev/ttyTHS0\', 115200, timeout=1) \n\ndef read_json_from_serial():\n    while True:\n        if ser.in_waiting > 0:\n            data = ser.readline()\n            print(data.decode().strip())\n\nif __name__ == "__main__":\n    print("Starting serial JSON reader on reComputer...")\n    read_json_from_serial()\n')),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/70.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("ol",{parentName:"admonition"},(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"My UART interface corresponds to ",(0,i.yg)("inlineCode",{parentName:"p"},"/dev/ttyTHS0"),", if yours doesn't, please modify it yourself.")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("p",{parentName:"li"},"This is a test script that you can use to check if the reComputer/Watcher's UART is working properly.")))),(0,i.yg)("p",null,"The second Python script builds upon the first one and adds JSON parsing and saving of image data:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"import json\nimport serial  \nimport base64\nfrom PIL import Image\nimport io\n\n# Set up the serial port\nser = serial.Serial('/dev/ttyTHS0', 115200, timeout=1)\n\n# Initialize image counters\nbig_image_counter = 1\nsmall_image_counter = 1\n\ndef read_json_from_serial(): \n    buffer = \"\"\n    try:\n        while True:\n            if ser.in_waiting > 0:\n                data = ser.read(ser.in_waiting).decode()  \n                buffer += data\n\n                if '}' in buffer:\n                    end = buffer.rfind('}')\n                    json_data = buffer[:end+1]\n                    buffer = buffer[end+1:]\n\n                    try:  \n                        data = json.loads(json_data)\n                        print(\"Received JSON data, processing...\")\n                        process_json_data(data)\n                    except json.JSONDecodeError:\n                        print(\"Error decoding JSON\")  \n                        buffer = json_data + buffer\n    except Exception as e:\n        print(f\"An error occurred: {e}\")\n\ndef process_json_data(data):\n    global big_image_counter, small_image_counter  # Declare global variables\n\n    # Process prompt info\n    if \"prompt\" in data:  \n        print(f\"Prompt: {data['prompt']}\")\n    \n    # Process boxes info\n    #if \"boxes\" in data:\n        #for index, box in enumerate(data['boxes']):\n            #print(f\"Box {index + 1} - x: {box['x']}, y: {box['y']}, w: {box['w']}, h: {box['h']}, score: {box['score']}, target_cls_id: {box['target_cls_id']}\")\n\n    if \"big_image\" in data:  \n        filename = f'big_image_{big_image_counter}.png'\n        decode_and_save_image(data['big_image'], filename) \n        print(f\"Big image processed and saved as {filename}.\")\n        big_image_counter += 1  # Update global variable \n\n    if \"small_image\" in data:\n        filename = f'small_image_{small_image_counter}.png' \n        decode_and_save_image(data['small_image'], filename)\n        print(f\"Small image processed and saved as {filename}.\")  \n        small_image_counter += 1  # Update global variable\n\ndef decode_and_save_image(base64_data, filename):\n    image_bytes = base64.b64decode(base64_data)\n    image = Image.open(io.BytesIO(image_bytes))\n    image.save(filename)  # Save as PNG file\n    return image\n\nif __name__ == \"__main__\": \n    print(\"Starting serial JSON reader on reComputer...\")\n    read_json_from_serial()\n")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Currently, only JSON data streams can be output, so only programs that parse JSON data streams are provided.")),(0,i.yg)("p",null,"This script does the following:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Reads JSON data from UART in a loop")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Decodes the JSON data and calls process_json_data to handle it")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Extracts prompt info and image data from the JSON")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Decodes the base64 encoded image data and saves as PNG files using ",(0,i.yg)("inlineCode",{parentName:"p"},"decode_and_save_image")))),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The parsing of information about recognised boxes (boxes) is not available at the moment, because the corresponding function of Watcher is still under development, and this information is not yet reported in the latest v1.0.1 version.")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Prints the extracted info and filenames of saved images")),(0,i.yg)("h3",{id:"uploading-the-code-to-recomputer"},"Uploading the Code to reComputer"),(0,i.yg)("p",null,"Create a new Python file on the reComputer, e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},"watcher_uart.py"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"nano watcher_uart.py\n")),(0,i.yg)("p",null,"Copy and paste the complete Python code into the file. Press Ctrl+X, then Y and Enter to save and exit the editor. Run the Python script:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"sudo python watcher_uart.py\n")),(0,i.yg)("h3",{id:"expected-results-2"},"Expected Results"),(0,i.yg)("br",null),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_getting_started/72.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("br",null),(0,i.yg)("p",null,"After running the script:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"The parsed JSON data received from the Watcher will be printed in the terminal in real-time, including the prompt information.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"The received big image and small image will be automatically saved as big_image_x.png and small_image_x.png files."))),(0,i.yg)("p",null,"That's it! You have now learned how to connect the Watcher to a reComputer, read the UART data with Python, parse the JSON, and save the transmitted images. Feel free to experiment further and adapt the code to your specific use case on the reComputer platform."),(0,i.yg)("h2",{id:"resources"},"Resources"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/getting_started_with_watcher/"},"Getting Started with SenseCAP Watcher"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/getting_started_with_watcher_task/"},"Watcher Quick Start Series 1# : How to assign tasks to Watcher"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/getting_started_with_watcher_look_tool"},"Watcher Quick Start Series 2# : Watcher Looks & SenseCraft Tools"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/watcher_as_grove"},"Watcher Quick Start Series 3# : As a sensor & Use Grove"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/watcher_local_deploy"},"Watcher Quick Start Series 4# : Deploy Watcher's AI capabilities locally"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Watcher Quick Start Series 5# : Training a model for Watcher")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/what_does_watcher_do"},"Watcher Quick Start Series 6# : What does Watcher do")))),(0,i.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,i.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,i.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,i.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"}))))}u.isMDXComponent=!0}}]);