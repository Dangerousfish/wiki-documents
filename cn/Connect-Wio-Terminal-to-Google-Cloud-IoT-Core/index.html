<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-zh-CN/Sensor/Wio_Terminal/Application/Easy_IoT/CN-Connect-Wio-Terminal-to-Google-Cloud-IoT-Core" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">将Wio Terminal连接到Google Cloud IoT Core | Seeed Studio Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wiki.seeedstudio.com/cn/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="将Wio Terminal连接到Google Cloud IoT Core | Seeed Studio Wiki"><meta data-rh="true" name="description" content="引言"><meta data-rh="true" property="og:description" content="引言"><meta data-rh="true" name="keywords" content="docs,docusaurus"><meta data-rh="true" property="og:image" content="https://wiki.seeedstudio.com/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/"><meta data-rh="true" name="twitter:image" content="https://wiki.seeedstudio.com/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/"><link data-rh="true" rel="icon" href="/img/S.png"><link data-rh="true" rel="canonical" href="https://wiki.seeedstudio.com/cn/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/"><link data-rh="true" rel="alternate" href="https://wiki.seeedstudio.com/cn/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://wiki.seeedstudio.com/cn/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Seeed Studio Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Seeed Studio Wiki Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-M4JG2HVB",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>


<link rel="icon" href="/img/S.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">


<link rel="search" type="application/opensearchdescription+xml" title="Seeed Studio Wiki" href="/opensearch.xml">
<script src="https://viewer.altium.com/client/static/js/embed.js" async></script>
<script src="/js/custom.js" async></script><link rel="stylesheet" href="/assets/css/styles.e121acb0.css">
<link rel="preload" href="/assets/js/runtime~main.2d21728f.js" as="script">
<link rel="preload" href="/assets/js/main.06a1b8bd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M4JG2HVB" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#013949;color:#FFFFFF" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Collaborating with us! Join the Seeed Studio <a target="_blank" href="https://wiki.seeedstudio.com/ranger/">Ranger Program</a> or <a target="_blank" href="https://wiki.seeedstudio.com/contributors/">Contributor Program</a>!</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://files.seeedstudio.com/wiki/wiki-platform/SeeedStudio.png" alt="Seeed Studio" class="themedImage_ToTc themedImage--light_HNdA navbar_logo_items"><img src="https://files.seeedstudio.com/wiki/wiki-platform/seeed_white_logo.png" alt="Seeed Studio" class="themedImage_ToTc themedImage--dark_i4oU navbar_logo_items"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items js_getting_started" aria-haspopup="true" aria-expanded="false" role="button" href="/Getting_Started/">Quick Links</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Sensor_Network/">Sensor and Sensing</a></li><li><a class="dropdown__link" href="/Network/">Networking</a></li><li><a class="dropdown__link" href="/Edge_Computing/">Edge Computing</a></li><li><a class="dropdown__link" href="/Cloud/">Cloud</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items js_explore_learn" aria-haspopup="true" aria-expanded="false" role="button" href="/topicintroduction/">Explore with Topics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tinyml_topic/">TinyML</a></li><li><a class="dropdown__link" href="/ModelAssistant_Introduce_Overview/">SenseCraft Model Assistant</a></li><li><a class="dropdown__link" href="/home_assistant_topic/">Home Assistant</a></li><li><a class="dropdown__link" href="/open_source_topic/">Open Source</a></li><li><a class="dropdown__link" href="/edge_ai_topic/">Edge AI</a></li><li><a class="dropdown__link" href="/cn/Getting_Started/">矽递科技 Wiki 文档平台</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/knowledgebase/">FAQs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Jetson_FAQ/">NVIDIA Jetson Series</a></li><li><a class="dropdown__link" href="/XIAO_FAQ/">Seeed Studio XIAO Series</a></li><li><a class="dropdown__link" href="/reComputer_R1000_FAQ/">reComputer R1000 Series</a></li><li><a class="dropdown__link" href="/reTerminal-new_FAQ/">reTerminal</a></li><li><a class="dropdown__link" href="/FAQs_For_openWrt/">reRouter</a></li><li><a class="dropdown__link" href="/ODYSSEY_FAQ/">Odyssey</a></li><li><a class="dropdown__link" href="/wio_terminal_faq/">Wio Terminal</a></li><li><hr style="margin: 8px 0;"></li><li><a href="https://discord.com/invite/eWkprNDMU7" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="dropdown__link">Email<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/Seeed-Studio/wiki-documents/discussions/69" target="_blank" rel="noopener noreferrer" class="dropdown__link">Have Suggestions?<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/ranger/">Rangers</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ranger/">Rangers</a></li><li><a class="dropdown__link" href="/contributors/">Contributors</a></li><li><a href="https://docs.google.com/forms/d/e/1FAIpQLSdiAWHmRJqgVNTJyJDkzhufc1dygFyhWFyEtUTm-mrgSKaEgg/viewform" target="_blank" rel="noopener noreferrer" class="dropdown__link">Apply for Rangers<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/orgs/Seeed-Studio/projects/6" target="_blank" rel="noopener noreferrer" class="dropdown__link">Direct to Assignments<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.seeedstudio.com/blog/2023/09/15/join-the-seeed-ranger-program-empowering-developers-and-building-communities/" target="_blank" rel="noopener noreferrer" class="dropdown__link">More about Rangers<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://wiki.seeedstudio.com/Contributor" target="_blank" rel="noopener noreferrer" class="dropdown__link">More about Contributors<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://www.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">Bazaar 🛍️</a><a href="https://wiki-gpt.seeedstudio.com/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">AI Bot 🤖️</a><a href="https://sensecraft.seeed.cc/ai/#/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">SenseCraft AI</a><a href="https://sensecraft.seeed.cc/ai/#/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-SSCMA"></a><a href="https://github.com/Seeed-Studio/wiki-documents" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Getting_Started/">矽递科技 Wiki 文档平台</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/Grove_System/">Grove 系列</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/grove_vision_ai_v2/">Grove 传感器</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/Grove_Accessories_Intro/">Grove 配件</a><button aria-label="Toggle the collapsible sidebar category &#x27;Grove 配件&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/SeeedStudio_XIAO_Series_Introduction/">XIAO 拇指开发板</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/Seeeduino-XIAO/">XIAO SAMD21</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO SAMD21&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/getting_started_xiao_ra4m1/">XIAO RA4M1</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO RA4M1&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/xiao_mg24_getting_started/">XIAO MG24</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO MG24&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/XIAO-RP2040/">XIAO RP2040</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO RP2040&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/getting-started-xiao-rp2350/">XIAO RP2350</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO RP2350&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/XIAO_BLE/">XIAO nRF52840 (Sense)</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO nRF52840 (Sense)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/XIAO_ESP32C3_Getting_Started/">XIAO ESP32C3</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO ESP32C3&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/xiao_esp32c6_getting_started/">XIAO ESP32C6</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO ESP32C6&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/xiao_esp32s3_getting_started/">XIAO ESP32S3 (Sense)</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO ESP32S3 (Sense)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/get_start_round_display/">XIAO 的兼容扩展板</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/xiao_idf/">XIAO + ESP-IDF + ESP- Matter</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/xiao_espnow/">ESP-NOW 登陆 XIAO ESP32 系列</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/PCB_Design_XIAO/">XIAO 的 PCB 设计</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/XIAO-Kit-Courses/">基于 XIAO 的初学者套件</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/xiao_topic_page/">XIAO 系列教程和项目合集</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/XIAO_FAQ/">XIAO 开发板常见问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/reComputer_Intro/">NVIDIA Jetson 套件</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/reComputer_Intro/">reComputer 英伟达系列</a><button aria-label="Toggle the collapsible sidebar category &#x27;reComputer 英伟达系列&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cn/Generative_AI_Intro/">生成式人工智能应用</a><button aria-label="Toggle the collapsible sidebar category &#x27;生成式人工智能应用&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/How_to_Train_and_Deploy_YOLOv8_on_reComputer/">计算机视觉应用</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/Wio_Terminal_Intro/">Wio Terminal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Wio-Terminal-Getting-Started-test/">Wio Terminal入门教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Wio-Terminal-CircuitPython/">Wio Terminal上的CircuitPython</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Software-FreeRTOS/">Wio Terminal上的FreeRTOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/wio_terminal_faq/">Wio Terminal 常见问题解答</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/Wio-Terminal-LCD-Overview/">硬件概述</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cn/Connect-Wio-Terminal-to-Microsoft-Azure-IoT-Central/">应用</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cn/Connect-Wio-Terminal-to-Microsoft-Azure-IoT-Central/">Easy IoT</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/Connect-Wio-Terminal-to-Microsoft-Azure-IoT-Central/">将Wio Terminal连接到Microsoft Azure IoT Central</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/Wio-Terminal-Azure-IOT/">将Wio Terminal连接到Microsoft Azure IoT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cn/Connect-Wio-Terminal-to-Google-Cloud-IoT-Core/">将Wio Terminal连接到Google Cloud IoT Core</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/Get-Started-with-Wio-Terminal-and-Wappsto-IoT/">Wio Terminal和Wappsto IoT入门指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cn/Wio-Terminal-TinyML-EI-1/">嵌入式机器学习</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/Wio-Terminal-Battery-Chassis/">扩展板</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/Wio-Terminal-TinyML-Kit-Course/">课程套件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/Wio-Terminal-Firmware/">教程</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/Quantum-Mini-Linux-Development-Kit/">夸克(Quark)迷你开发者套件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/cn/mmwave_radar_Intro/">毫米波雷达传感器</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/mmwave_for_xiao/">用于XIAO的毫米波</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cn/mmwave_human_detection_kit/">毫米波套件</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR24BSD1/">24GHz 毫米波传感器 - 睡眠呼吸监测</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR24FDB1/">24GHz毫米波传感器 - 人体跌倒检测传感器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR24HPB1/">24GHz 毫米波传感器 - 人体静态存在模块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR24HPC1/">24GHz毫米波传感器 - 人体静态存在模块精简版</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR60BHA1/">60GHz毫米波传感器 - 人体静态睡眠呼吸监测</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/Radar_MR60FDA1/">60GHz毫米波传感器 - 跌倒检测模块专业版</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">应用</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Easy IoT</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">将Wio Terminal连接到Google Cloud IoT Core</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>将Wio Terminal连接到Google Cloud IoT Core</h1><p><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/thumb.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="引言">引言<a href="#引言" class="hash-link" aria-label="Direct link to 引言" title="Direct link to 引言">​</a></h2><p>在本教程中，我们将带您逐步了解如何将Wio Terminal连接到Google Cloud IoT Core，并将来自Wio Terminal的遥测数据发送到Google Cloud IoT Core。这将分为两个部分，第一部分将介绍如何使用已预配置在代码中的令人兴奋的库发送遥测数据，而第二部分将介绍如何将自己的传感器添加到Wio Terminal，并将遥测数据发送到Google Cloud IoT Core。Google Cloud IoT Core支持HTTP和MQTT协议进行通信，但在本教程中，我们将使用MQTT协议。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是google-cloud">什么是Google Cloud?<a href="#什么是google-cloud" class="hash-link" aria-label="Direct link to 什么是Google Cloud?" title="Direct link to 什么是Google Cloud?">​</a></h3><p><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud</a> 由一系列物理资产（如计算机和硬盘驱动器）和虚拟资源（如虚拟机）组成，这些资源位于全球各地的Google数据中心中。资源的分布提供了多个优势，包括在故障发生时的冗余备份和通过将资源靠近客户端来减少延迟。</p><p>在云计算中，您可能习惯将软件和硬件产品视为服务。这些服务提供对底层资源的访问。<a href="https://cloud.google.com/products" target="_blank" rel="noopener noreferrer">Google Cloud提供的服务种类</a> 繁多，而且不断增长。当您在Google Cloud上开发您的网站或应用程序时，您可以将这些服务进行组合，以创建满足您需求的基础设施，并添加您的代码来实现您想要构建的场景。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是google-cloud平台">什么是Google Cloud平台?<a href="#什么是google-cloud平台" class="hash-link" aria-label="Direct link to 什么是Google Cloud平台?" title="Direct link to 什么是Google Cloud平台?">​</a></h3><p><a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud 平台 (GCP)</a>是一组云计算服务的集合。通过一系列管理工具，它提供了一系列模块化的云服务，包括计算、数据存储、数据分析和机器学习等。GCP提供基础设施即服务（IaaS）、平台即服务（PaaS）和无服务器计算环境。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是google-cloud-iot-core">什么是Google Cloud IoT Core?<a href="#什么是google-cloud-iot-core" class="hash-link" aria-label="Direct link to 什么是Google Cloud IoT Core?" title="Direct link to 什么是Google Cloud IoT Core?">​</a></h3><p><a href="https://cloud.google.com/iot/docs" target="_blank" rel="noopener noreferrer">Google Cloud Internet of Things (IoT) Core</a> 是一个全面托管的服务，用于安全地连接和管理物联网设备，无论是几个还是数百万个设备。它可以接收来自连接设备的数据，并构建与Google Cloud Platform的其他大数据服务集成的丰富应用程序。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是google-cloud-console">什么是Google Cloud Console?<a href="#什么是google-cloud-console" class="hash-link" aria-label="Direct link to 什么是Google Cloud Console?" title="Direct link to 什么是Google Cloud Console?">​</a></h3><p><a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud Console</a> 提供了一个基于Web的图形用户界面，您可以使用它来管理Google Cloud Platform资源。当您使用Cloud Console时，您可以创建一个新项目或选择一个现有项目，并在该项目的上下文中使用您创建的资源。您可以创建多个项目，因此可以根据自己的需求将工作分隔开来。例如，如果您希望只有特定团队成员可以访问该项目中的资源，而所有团队成员仍可以访问另一个项目中的资源，那么您可以启动一个新项目。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="将wio-terminal通过mqtt连接到google-cloud-iot-core">将Wio Terminal通过MQTT连接到Google Cloud IoT Core<a href="#将wio-terminal通过mqtt连接到google-cloud-iot-core" class="hash-link" aria-label="Direct link to 将Wio Terminal通过MQTT连接到Google Cloud IoT Core" title="Direct link to 将Wio Terminal通过MQTT连接到Google Cloud IoT Core">​</a></h2><p>正如之前所解释的，我们将使用可用的MQTT桥来实现Wio Terminal与Google Cloud IoT Core之间的通信。然而，如果您有特定的要求，也可以使用HTTP桥接。</p><p><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/5555555.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud-console-设置">Google Cloud Console 设置<a href="#google-cloud-console-设置" class="hash-link" aria-label="Direct link to Google Cloud Console 设置" title="Direct link to Google Cloud Console 设置">​</a></h3><p>首先，我们需要访问Google Cloud Console，创建一个Cloud IoT Core设备注册表并注册设备。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="初始设置">初始设置<a href="#初始设置" class="hash-link" aria-label="Direct link to 初始设置" title="Direct link to 初始设置">​</a></h4><ul><li><strong>步骤 1:</strong> 访问 <a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">此处</a> 创建一个新项目</li></ul><p><strong>注:</strong> 如有提示，请使用您的Google账户登录</p><ul><li><p><strong>步骤 2:</strong> 点击 <strong>Select a project</strong> 菜单</p></li><li><p><strong>步骤 3:</strong> 点击 <strong>NEW PROJECT</strong> 并输入一个 <strong>项目名</strong></p></li><li><p><strong>步骤 4:</strong> 点击 <strong>CREATE</strong> </p></li><li><p><strong>步骤 5:</strong> 为您的云项目启用计费。这是为了确保您不是机器人，并且不会产生费用。在导航菜单中选择&quot;计费&quot;，并按照设置进行操作。</p></li></ul><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/1111111.png" alt="pir" width="500" height="auto" class="img_ev3q"></p><ul><li><strong>步骤 6:</strong> 访问 <a href="https://console.cloud.google.com/flows/enableapi?apiid=cloudiot.googleapis.com%2Cpubsub&amp;authuser=3&amp;_ga=2.254170561.853675115.1607885458-878786893.1606048800" target="_blank" rel="noopener noreferrer">此处</a>启用Cloud IoT Core和Cloud Pub/Sub API</li></ul><p><strong>注:</strong> 从下拉菜单中选择您之前创建的项目</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="创建设备注册表">创建设备注册表<a href="#创建设备注册表" class="hash-link" aria-label="Direct link to 创建设备注册表" title="Direct link to 创建设备注册表">​</a></h4><ul><li><p><strong>步骤 1:</strong> 在Cloud控制台中访问 <a href="https://console.cloud.google.com/iot/registries" target="_blank" rel="noopener noreferrer">Google Cloud IoT Core页面</a> </p></li><li><p><strong>步骤 2:</strong> 点击 <strong>Create Registry</strong></p></li><li><p><strong>步骤 3:</strong> 输入一个 <strong>registry ID</strong></p></li></ul><p><strong>注:</strong> 这是您注册表的名称</p><ul><li><strong>步骤 4:</strong> 选择一个 <strong>Region</strong></li></ul><p><strong>注:</strong>  如果您在美国，请选择us-central1作为区域。如果您在美国以外，请选择您首选的区域。</p><ul><li><p><strong>步骤 5:</strong> 在 <strong>Select a Cloud Pub/Sub topic</strong> 的下拉列表中, 选择 <strong>Create a topic</strong> 并输入您首选的 <strong>Topic ID</strong></p></li><li><p><strong>步骤 6:</strong> 点击 <strong>CREATE TOPIC</strong></p></li><li><p><strong>步骤 7:</strong> 点击 <strong>SHOW ADVANCED OPTIONS</strong></p></li><li><p><strong>步骤 8:</strong>  <strong>Device state topic</strong> 和 <strong>Certificate value</strong> 字段是可选的，所以留空即可</p></li><li><p><strong>步骤 9:</strong> 选择 <strong>MQTT</strong> 作为 <strong>Protocol</strong></p></li><li><p><strong>步骤 10:</strong> 在Cloud IoT Core页面上点击 <strong>Create</strong> </p></li></ul><p>现在我们已经创建了一个带有Cloud Pub/Sub主题的设备注册表，用于发布设备遥测事件。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="生成设备密钥对-ec-keys">生成设备密钥对 (EC Keys)<a href="#生成设备密钥对-ec-keys" class="hash-link" aria-label="Direct link to 生成设备密钥对 (EC Keys)" title="Direct link to 生成设备密钥对 (EC Keys)">​</a></h4><p>Cloud IoT Core使用公钥（或非对称）身份验证：</p><ul><li>设备使用私钥对 <a href="https://cloud.google.com/iot/docs/how-tos/credentials/jwts" target="_blank" rel="noopener noreferrer">JSON Web Token (JWT)</a>进行签名。该令牌作为设备身份的证明传递给Cloud IoT Core。 </li><li>服务使用设备的公钥（在发送JWT之前上传）来验证设备的身份。</li></ul><p>Cloud IoT Core支持RSA和椭圆曲线算法，本教程将使用椭圆曲线密钥。</p><ul><li><p><strong>步骤 1:</strong> 在您的计算机上创建一个新文件夹。</p></li><li><p><strong>步骤 2:</strong> 从终端窗口导航到该文件夹，并输入以下命令生成P-256椭圆曲线密钥对：</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ecparam -genkey -name prime256v1 -noout -out ec_private.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ec -in ec_private.pem -pubout -out ec_public.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>注:</strong>  确保按照  <a href="https://slproweb.com/products/Win32OpenSSL.html" target="_blank" rel="noopener noreferrer">此链接</a> 安装<strong>openssl</strong> 并将其目录位置添加到PATH中。</p><p>上述命令将生成以下公钥/私钥对：</p><ul><li><strong>ec_private.pem</strong>: 私钥，必须安全存储在设备上，并用于对身份验证JWT进行签名。</li><li><strong>ec_public.pem</strong>: 公钥，必须存储在Cloud IoT Core中，并用于验证身份验证JWT的签名。</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提取私钥">提取私钥<a href="#提取私钥" class="hash-link" aria-label="Direct link to 提取私钥" title="Direct link to 提取私钥">​</a></h4><p>我们需要提取私钥的字节并将其复制到稍后在本教程中创建的Arduino项目的私钥字符串中。暂时保存这些密钥以备后用。</p><ul><li><p><strong>步骤 1:</strong> 打开一个终端窗口，并导航到包含我们之前生成的椭圆曲线密钥对的文件夹。 </p></li><li><p><strong>步骤 2:</strong> 输入以下命令</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ec -in ec_private.pem -noout -text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 3:</strong> 将生成的私钥字节（在 <strong>priv:</strong> 下方）复制并粘贴到记事本中，并保存以备后用。</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="将设备添加到注册表">将设备添加到注册表<a href="#将设备添加到注册表" class="hash-link" aria-label="Direct link to 将设备添加到注册表" title="Direct link to 将设备添加到注册表">​</a></h4><ul><li><p><strong>步骤 1:</strong> 访问 <a href="https://console.cloud.google.com/iot/registries" target="_blank" rel="noopener noreferrer">Registries page</a> 并选择之前创建的注册表</p></li><li><p><strong>步骤 2:</strong> 选择 <strong>Devices</strong> 设备选项卡，然后点击 <strong>CREATE A DEVICE</strong></p></li><li><p><strong>步骤 3:</strong> 输入一个 <strong>Device ID</strong></p></li><li><p><strong>步骤 4:</strong>  <strong>Device metadata</strong> 字段是可选的，所以留空即可</p></li><li><p><strong>步骤 5:</strong> 点击 <strong>COMMUNICATION, CLOUD LOGGING, AUTHENTICATION</strong> 下拉菜单 </p></li><li><p><strong>步骤 6:</strong> 为  <strong>Device communication</strong>选择<strong>Allow</strong></p></li><li><p><strong>步骤 7:</strong> 在 <strong>Authentication</strong> 身份验证字段中，在 <strong>Input method</strong>输入方法下拉菜单中, 选择 <strong>Upload</strong></p></li><li><p><strong>步骤 8:</strong> 在<strong>Public key format</strong>公钥格式下拉菜单中选择 <strong>ES256</strong> </p></li><li><p><strong>步骤 9:</strong> 在<strong>Public key value</strong>公钥值下方，点击 <strong>BROWSE</strong> 浏览按钮，导航到我们之前创建的<strong>Elliptic Curve key pair</strong> 并选择 <strong>ec_public.pem</strong></p></li><li><p><strong>步骤 10:</strong> 点击 <strong>Create</strong></p></li></ul><p>现在您已将设备添加到注册表中。ES256密钥将显示在设备详细信息页面上。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="设置订阅者">设置订阅者<a href="#设置订阅者" class="hash-link" aria-label="Direct link to 设置订阅者" title="Direct link to 设置订阅者">​</a></h4><p>现在我们已经创建了设备注册表、创建了一个主题并将设备添加到该注册表中，接下来让我们继续创建一个订阅者，以订阅我们创建的主题，以便从Wio Terminal获取遥测数据。</p><ul><li><strong>步骤 1:</strong> 在Google Cloud控制台的搜索栏中输入 <strong>Pub</strong> 然后从结果中选择 <strong>Pub/Sub</strong> 。</li></ul><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/333333.png" alt="pir" width="700" height="auto" class="img_ev3q"></p><ul><li><p><strong>步骤 2:</strong> 在导航栏点击 <strong>Subscriptions</strong> </p></li><li><p><strong>步骤 3:</strong> 点击 <strong>CREATE SUBSCRIPTION</strong> </p></li><li><p><strong>步骤 4:</strong> 输入您选择的 <strong>Subscription ID</strong> </p></li><li><p><strong>步骤 5:</strong> 从<strong>Select a Cloud Pub/Sub topic</strong>下拉菜单中选择我们之前创建的 <strong>Pub/Sub topic</strong> </p></li><li><p><strong>步骤 6:</strong> 将传递方式设置为 <strong>Pull</strong> </p></li><li><p><strong>步骤 7:</strong> 点击 <strong>Create</strong> </p></li></ul><p>现在我们已经完成了Google Cloud IoT Core的设置。接下来，我们将继续设置Wio Terminal和Arduino IDE。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用arduino设置wio-terminal">使用Arduino设置Wio Terminal<a href="#使用arduino设置wio-terminal" class="hash-link" aria-label="Direct link to 使用Arduino设置Wio Terminal" title="Direct link to 使用Arduino设置Wio Terminal">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="所需库">所需库<a href="#所需库" class="hash-link" aria-label="Direct link to 所需库" title="Direct link to 所需库">​</a></h4><p>我们需要两个库来完成本教程。 </p><ol><li>lwMQTT MQTT Arduino 库</li><li>Google Cloud IoT Arduino 库</li></ol><p>下载这些库:</p><ul><li><strong>步骤 1:</strong> 打开 Arduino IDE</li><li><strong>步骤 2:</strong> 导航到 <code>Sketch &gt; Include Library &gt; Manage Libraries</code></li><li><strong>步骤 3:</strong> 在搜索框中键入 <strong>lwMQTT</strong> 和 <strong>Google Cloud IoT</strong> 然后安装这些库</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置凭据和帐户信息">配置凭据和帐户信息<a href="#配置凭据和帐户信息" class="hash-link" aria-label="Direct link to 配置凭据和帐户信息" title="Direct link to 配置凭据和帐户信息">​</a></h4><p>现在我们需要在 <strong>ciotc_config.h</strong>文件中设置Wi-Fi凭据和Google Cloud IoT Core信息。</p><ul><li><p><strong>步骤 1:</strong> 在Arduino IDE中，选择 <code>File &gt; Examples &gt; Google Cloud IoT JWT &gt; Esp32-lwmqtt</code></p></li><li><p><strong>步骤 2:</strong> 导航到 <strong>ciotc_config.h</strong></p></li><li><p><strong>步骤 3:</strong> 更改 <strong>Wifi network details</strong></p></li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *ssid = &quot;Enter_SSID&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *password = &quot;Enter_Password&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 4:</strong> 更改 <strong>Google Cloud IoT details</strong></li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *project_id = &quot;Enter_Project_ID&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *location = &quot;Enter_location&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *registry_id = &quot;Enter_Registry_ID&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *device_id = &quot;Enter_Device_ID&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 5:</strong> 将我们从 <strong>ec_private.pem</strong> 中获取的私钥字节复制到记事本中保存的位置</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char *private_key_str =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;6e:b8:17:35:c7:fc:6b:d7:a9:cb:cb:49:7f:a0:67:&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;63:38:b0:90:57:57:e0:c0:9a:e8:6f:06:0c:d9:ee:&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;31:41&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>注:</strong> 密钥长度应为32对十六进制数字</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="更改ntp时间方法">更改NTP时间方法<a href="#更改ntp时间方法" class="hash-link" aria-label="Direct link to 更改NTP时间方法" title="Direct link to 更改NTP时间方法">​</a></h4><p>打开 <strong>esp32-mqtt.h</strong> 文件，并用以下代码替换整个文件。这里我们使用通过UDP获取NTP时间的实现替换了configTime函数。</p><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;Client.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;rpcWiFi.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;WiFiClientSecure.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;MQTT.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;CloudIoTCore.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;CloudIoTCoreMqtt.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;ciotc_config.h&quot; // Update this file with your configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// !!REPLACEME!!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// The MQTT callback function for commands and configuration updates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Place your message handler code here.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void messageReceived(String &amp;topic, String &amp;payload){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;incoming: &quot; + topic + &quot; - &quot; + payload);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Initialize WiFi and MQTT for this board</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//Client *netClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CloudIoTCoreDevice *device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CloudIoTCoreMqtt *mqtt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MQTTClient *mqttClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned long iat = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String jwt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WiFiUDP udp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned int localPort = 2390;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned long devicetime;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const int NTP_PACKET_SIZE = 48; // NTP time stamp is in the first 48 bytes of the message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">byte packetBuffer[NTP_PACKET_SIZE]; //buffer to hold incoming and outgoing packets</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// send an NTP request to the time server at the given address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned long sendNTPpacket(const char* address) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // set all bytes in the buffer to 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    for (int i = 0; i &lt; NTP_PACKET_SIZE; ++i) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        packetBuffer[i] = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Initialize values needed to form NTP request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // (see URL above for details on the packets)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[0] = 0b11100011;   // LI, Version, Mode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[1] = 0;     // Stratum, or type of clock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[2] = 6;     // Polling Interval</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[3] = 0xEC;  // Peer Clock Precision</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 8 bytes of zero for Root Delay &amp; Root Dispersion</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[12] = 49;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[13] = 0x4E;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[14] = 49;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packetBuffer[15] = 52;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // all NTP fields have been given values, now</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // you can send a packet requesting a timestamp:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    udp.beginPacket(address, 123); //NTP requests are to port 123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    udp.write(packetBuffer, NTP_PACKET_SIZE);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    udp.endPacket();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned long getNTPtime() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // module returns a unsigned long time valus as secs since Jan 1, 1970 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // unix time or 0 if a problem encounted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //only send data when connected</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (WiFi.status() == WL_CONNECTED) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //initializes the UDP state</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        //This initializes the transfer buffer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        udp.begin(WiFi.localIP(), localPort);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sendNTPpacket(ntp_primary); // send an NTP packet to a time server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // wait to see if a reply is available</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        delay(1000);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (udp.parsePacket()) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//            Serial.println(&quot;udp packet received&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//            Serial.println(&quot;&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // We&#x27;ve received a packet, read the data from it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            udp.read(packetBuffer, NTP_PACKET_SIZE); // read the packet into the buffer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //the timestamp starts at byte 40 of the received packet and is four bytes,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // or two words, long. First, extract the two words:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            unsigned long highWord = word(packetBuffer[40], packetBuffer[41]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            unsigned long lowWord = word(packetBuffer[42], packetBuffer[43]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // combine the four bytes (two words) into a long integer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // this is NTP time (seconds since Jan 1 1900):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            unsigned long secsSince1900 = highWord &lt;&lt; 16 | lowWord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Unix time starts on Jan 1 1970. In seconds, that&#x27;s 2208988800:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            const unsigned long seventyYears = 2208988800UL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // subtract seventy years:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            unsigned long epoch = secsSince1900 - seventyYears;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // adjust time for timezone offset in secs +/- from UTC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // WA time offset from UTC is +8 hours (28,800 secs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // + East of GMT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // - West of GMT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//            long tzOffset = 28800UL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            long tzOffset = 0UL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // WA local time </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            unsigned long adjustedTime;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return adjustedTime = epoch + tzOffset;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // were not able to parse the udp packet successfully</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // clear down the udp connection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            udp.stop();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return 0; // zero indicates a failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // not calling ntp time frequently, stop releases resources</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        udp.stop();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // network not connected</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Helpers specific to this board</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String getDefaultSensor(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return &quot;Wifi: &quot; + String(WiFi.RSSI()) + &quot;db&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String getJwt(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;Refreshing JWT&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iat = getNTPtime();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(iat);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  jwt = device-&gt;createJWT(iat, jwt_exp_secs);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(jwt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return jwt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setupWifi(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;Starting wifi&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  WiFi.mode(WIFI_STA);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // WiFi.setSleep(false); // May help with disconnect? Seems to have been removed from WiFi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  WiFi.begin(ssid, password);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;Connecting to WiFi&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  while (WiFi.status() != WL_CONNECTED){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delay(100);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//  configTime(0, 0, ntp_primary, ntp_secondary);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;Waiting on time sync...&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//  Serial.println(getNTPtime());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  while (getNTPtime() &lt; 1510644967){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delay(10);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void connectWifi(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.print(&quot;checking wifi...&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  while (WiFi.status() != WL_CONNECTED){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Serial.print(&quot;.&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delay(1000);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Orchestrates various methods from preceeding code.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool publishTelemetry(String data){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return mqtt-&gt;publishTelemetry(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool publishTelemetry(const char *data, int length){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return mqtt-&gt;publishTelemetry(data, length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool publishTelemetry(String subfolder, String data){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return mqtt-&gt;publishTelemetry(subfolder, data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool publishTelemetry(String subfolder, const char *data, int length){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return mqtt-&gt;publishTelemetry(subfolder, data, length);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void connect(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  connectWifi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqtt-&gt;mqttConnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WiFiClientSecure netClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setupCloudIoT(){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  device = new CloudIoTCoreDevice(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      project_id, location, registry_id, device_id,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      private_key_str);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  setupWifi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//  netClient = new WiFiClientSecure();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqttClient = new MQTTClient(512);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqttClient-&gt;setOptions(180, true, 1000); // keepAlive, cleanSession, timeout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqtt = new CloudIoTCoreMqtt(mqttClient, &amp;netClient, device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqtt-&gt;setUseLts(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mqtt-&gt;startMQTT();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="在esp32-lwmqttino文件中添加宏定义">在Esp32-lwmqtt.ino文件中添加宏定义<a href="#在esp32-lwmqttino文件中添加宏定义" class="hash-link" aria-label="Direct link to 在Esp32-lwmqtt.ino文件中添加宏定义" title="Direct link to 在Esp32-lwmqtt.ino文件中添加宏定义">​</a></h4><p>在<strong>Esp32-lwmqtt.ino</strong>文件中，将Wio Terminal板添加到宏定义中。</p><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if defined(ESP32) || defined(WIO_TERMINAL)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define __ESP32_MQTT_H__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>现在我们已经完成了Arduino IDE的设置。最后，您需要将此代码上传到Wio Terminal。打开串行监视器，您将看到以下内容显示。</p><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/4444444.png" alt="pir" width="700" height="auto" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="显示遥测数据">显示遥测数据<a href="#显示遥测数据" class="hash-link" aria-label="Direct link to 显示遥测数据" title="Direct link to 显示遥测数据">​</a></h3><p>现在我们需要显示来自Wio Terminal的传入遥测数据。在这个示例代码中，Wi-Fi信号强度将作为遥测数据发送。</p><ul><li><strong>步骤 1:</strong> 在Google Cloud控制台中访问 <strong>Pub/Sub</strong></li></ul><p><strong>注:</strong> 您可以在Google Cloud控制台的搜索栏中搜索 <strong>Pub</strong> </p><ul><li><p><strong>步骤 2:</strong> 导航到导航菜单中的 <strong>Subscriptions</strong> </p></li><li><p><strong>步骤 3:</strong> 选择我们之前创建的订阅ID</p></li><li><p><strong>步骤 4:</strong> 点击 <strong>VIEW MESSAGES</strong></p></li><li><p><strong>步骤 5:</strong> C点击 <strong>PULL</strong> 您将看到传入的遥测数据如下所示</p></li></ul><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/6666666.png" alt="pir" width="950" height="auto" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何添加其他传感器">如何添加其他传感器？<a href="#如何添加其他传感器" class="hash-link" aria-label="Direct link to 如何添加其他传感器？" title="Direct link to 如何添加其他传感器？">​</a></h3><p>您可以向Wio Terminal添加任何传感器，并将遥测数据发送到Google Cloud IoT Core。为了简单起见，我们将使用Wio Terminal上的内置光传感器将光强度级别发送到Google Cloud IoT Core。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud-iot设置">Google Cloud IoT设置<a href="#google-cloud-iot设置" class="hash-link" aria-label="Direct link to Google Cloud IoT设置" title="Direct link to Google Cloud IoT设置">​</a></h4><ul><li><strong>步骤 1:</strong> 在Google Cloud控制台中访问 <strong>IoT Core</strong> </li></ul><p><strong>注:</strong> 您可以在Google Cloud控制台的搜索栏中搜索 <strong>IoT Core</strong> </p><ul><li><p><strong>步骤 2:</strong> 选择我们之前创建的注册表</p></li><li><p><strong>步骤 3:</strong> 在Cloud <strong>Pub/Sub topics</strong> 下选择 <strong>Add or edit topics</strong></p></li><li><p><strong>步骤 4:</strong> 点击 <strong>ADD ADDITIONAL TOPIC</strong></p></li><li><p><strong>步骤 5:</strong> 从   <strong>Select a Cloud Pub/Sub topic</strong>的下拉菜单中选择<strong>CREATE A TOPIC</strong></p></li><li><p><strong>步骤 6:</strong> 输入一个 <strong>Topic ID</strong> 然后点击 <strong>CREATE TOPIC</strong></p></li><li><p><strong>步骤 7:</strong> 在 <strong>Subfolder</strong> 列中输入一个<strong>Subfolder name</strong></p></li></ul><p><strong>注:</strong> 子文件夹名称将用于与Arduino代码中的主题相关联</p><ul><li><p><strong>步骤 8:</strong> 点击 <strong>UPDATE</strong></p></li><li><p><strong>步骤 9:</strong> 创建一个 <strong>new subscription</strong> 如前所述</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="arduino-设置">Arduino 设置<a href="#arduino-设置" class="hash-link" aria-label="Direct link to Arduino 设置" title="Direct link to Arduino 设置">​</a></h4><p>打开 <strong>Esp32-lwmqtt.ino</strong> 文件并按照以下步骤进行操作：</p><ul><li><strong>步骤 1:</strong>  在循环结束后，添加以下代码以使用内置光传感器：</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  int light = analogRead(WIO_LIGHT); //assign variable to store light sensor values </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  light = map(light,0,1023,0,100); //Map sensor values  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 2:</strong>  在代码中添加使用子文件夹名称的主题</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publishTelemetry(getDefaultSensor());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publishTelemetry(&quot;/light&quot;,String(light));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>注:</strong> 如果未添加子文件夹名称，遥测数据将被发送到默认主题。在这种情况下，如前所述，Wi-Fi信号强度的遥测数据将被发送到之前创建的第一个主题，即默认主题。</p><p>在将代码上传到Wio Terminal后，作为一个订阅者从新创建的主题中接收数据，您将会看到以下结果。</p><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/222222.png" alt="pir" width="950" height="auto" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何将其他传感器添加到wio-terminal并在仪表板上可视化数据">如何将其他传感器添加到Wio Terminal并在仪表板上可视化数据？<a href="#如何将其他传感器添加到wio-terminal并在仪表板上可视化数据" class="hash-link" aria-label="Direct link to 如何将其他传感器添加到Wio Terminal并在仪表板上可视化数据？" title="Direct link to 如何将其他传感器添加到Wio Terminal并在仪表板上可视化数据？">​</a></h3><p>虽然Google Cloud IoT Core没有提供用于可视化传感器数据的即用仪表板，但我们可以使用InfluxDB和Grafana来实现。</p><p><a href="https://www.influxdata.com/" target="_blank" rel="noopener noreferrer">InfluxDB</a> 是一个时间序列数据库，每个数据都与一个时间戳相关联，显示与该数据相关的日期和时间。而  <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">Grafana</a>  则是一个用于运行数据分析、提取有意义的指标并通过可自定义的仪表板监控应用程序的开源解决方案。</p><p>基本上，我们将连接一个温湿度传感器到Wio Terminal，使用Google Cloud Function将来自Pub/Sub的数据传输到位于GKE（Google Kubernetes Engine）集群中的InfluxDB，并使用交互式仪表板在Grafana上显示来自InfluxDB的数据。</p><p><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/thumb.png" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="arduino的硬件设置">Arduino的硬件设置<a href="#arduino的硬件设置" class="hash-link" aria-label="Direct link to Arduino的硬件设置" title="Direct link to Arduino的硬件设置">​</a></h4><p>将Grove - 温湿度传感器（DHT11）连接到Wio Terminal的Grove - 数字/模拟端口（D0）。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="arduino的软件设置">Arduino的软件设置<a href="#arduino的软件设置" class="hash-link" aria-label="Direct link to Arduino的软件设置" title="Direct link to Arduino的软件设置">​</a></h4><ul><li><p><strong>步骤 1:</strong> 访问 <a href="https://github.com/Seeed-Studio/Grove_Temperature_And_Humidity_Sensor" target="_blank" rel="noopener noreferrer">Grove - Temperature and Humidity Sensor repo</a> 并将其下载为zip文件</p></li><li><p><strong>步骤 2:</strong> 打开 Arduino, 导航到 <code>Sketch &gt; Include Library &gt; Add .ZIP Library</code> 然后选择下载的库进行安装</p></li></ul><p>在之前使用的 <strong>Esp32-lwmqtt.ino</strong> Esp32-lwmqtt.ino文件中，按照以下步骤进行操作：</p><ul><li><strong>步骤 1:</strong> 在 <strong>#include &quot;esp32-mqtt.h&quot;</strong>之后添加以下代码：</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;DHT.h&quot; //DHT library</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define DHTPIN 0 //Define Signal Pin of DHT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define DHTTYPE DHT11 //Define DHT Sensor Type</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DHT dht(DHTPIN, DHTTYPE); //Initializing DHT sensor  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 2:</strong> 在 <strong>setup</strong> 函数中添加以下代码以启动DHT传感器</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dht.begin(); </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 3:</strong>  在<strong>void loop()</strong>函数的<strong>if loop</strong>内部添加以下代码：</li></ul><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">int temperature = dht.readTemperature(); //Assign variable to store temperature</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int humidity = dht.readHumidity(); //Assign variable to store humidity</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String payload = String(&quot;{\&quot;timestamp\&quot;:&quot;) + getNTPtime() +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  String(&quot;,\&quot;temperature\&quot;:&quot;) temperature +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  String(&quot;,\&quot;humidity\&quot;:&quot;) + humidity +</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  String(&quot;}&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">publishTelemetry(payload); </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> 在这里，我们将所有数据解析为字符串，并将其发送到InfluxDB。 <strong>time</strong> 非常重要，因为InfluxDB是一个时间序列数据库。此外， <strong>pushTelemetry</strong> 函数将会将数据发送到我们在本教程一开始创建的默认主题。</p><ul><li><strong>步骤 4:</strong> 将代码上传到Wio Terminal</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud-iot-设置">Google Cloud IoT 设置<a href="#google-cloud-iot-设置" class="hash-link" aria-label="Direct link to Google Cloud IoT 设置" title="Direct link to Google Cloud IoT 设置">​</a></h4><ul><li><p><strong>步骤 1:</strong> 访问 <a href="https://github.com/lakshanthad/esp32-cloud-iot-core-k8s" target="_blank" rel="noopener noreferrer">此存储库</a> 并将其下载为zip文件</p></li><li><p><strong>步骤 2:</strong> 解压下载的zip文件 </p></li><li><p><strong>步骤 3:</strong> 打开Google Cloud控制台，并导航到 <a href="https://console.cloud.google.com/kubernetes/list" target="_blank" rel="noopener noreferrer">Google Kubernetes Engine</a> ，等待系统初始化</p></li><li><p><strong>步骤 4:</strong> 通过点击右上角的按钮启动 Cloud shell</p></li></ul><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/cloud_shell_1.png" alt="pir" width="700" height="auto" class="img_ev3q"></p><ul><li><strong>步骤 5:</strong> 输入以下命令来设置gcloud命令行工具的默认值</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">export ZONE=&lt;enter_zone&gt; # e.g. us-central1-a, see https://cloud.google.com/compute/docs/regions-zones/#available</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export PROJECT_ID=&lt;enter_project-id&gt; # project ID name </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcloud config set project $PROJECT_ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcloud config set compute/zone $ZONE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 6:</strong> 输入以下命令来创建一个包含一个n1-standard-1节点的GKE集群</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcloud container clusters create influxdb-grafana \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                --num-nodes 1 \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                --machine-type n1-standard-1 \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                --zone $ZONE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 7:</strong> 输入以下命令来创建一个用于存储InfluxDB和Grafana身份验证信息的密钥</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl create secret generic influxdb-grafana \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --from-literal=influxdb-user=admin \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --from-literal=influxdb-password=passw0rd \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --from-literal=grafana-user=admin \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --from-literal=grafana-password=passw0rd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>注:</strong> 您根据您的喜好更改InfluxDB和Grafana的用户名和密码</p><ul><li><p><strong>步骤 8:</strong> 在Google Shell中点击 <strong>Open Editor</strong> </p></li><li><p><strong>步骤 9:</strong> 将之前下载并解压的文件夹拖放到 <strong>Cloud Shell Editor</strong>中</p></li><li><p><strong>步骤 10:</strong> 点击 <strong>Open Terminal</strong> 返回到终端，通过输入以下命令导航到 <strong>05-influxdb_grafana_k8s</strong> 目录</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd esp32-cloud-iot-core-k8s-master/05-influxdb_grafana_k8s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 11:</strong> 输入以下命令将InfluxDB和Grafana部署到Kubernetes集群中</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl create -f k8s/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-设置">Grafana 设置<a href="#grafana-设置" class="hash-link" aria-label="Direct link to Grafana 设置" title="Direct link to Grafana 设置">​</a></h4><ul><li><strong>步骤 1:</strong> 输入以下命令来检查服务的外部IP地址/端口</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get services</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>步骤 2:</strong> 复制Grafana的外部IP地址</p></li><li><p><strong>步骤 3:</strong> 在浏览器中访问 <code>http://&lt;grafana service external ip&gt;:3000</code></p></li></ul><p><strong>Note:</strong> 将之前复制的Grafana外部IP粘贴到 <code>&lt;grafana service external ip&gt;</code>中</p><ul><li><p><strong>步骤 4:</strong> 使用之前设置的凭据登录到Grafana</p></li><li><p><strong>步骤 5:</strong> 点击齿轮图标，导航到 <code>Configuration &gt; Data Sources</code></p></li><li><p><strong>步骤 6:</strong> 点击 <strong>Add data source</strong> 选择 <strong>influxDB</strong></p></li><li><p><strong>步骤 7:</strong> 在 <strong>URL</strong> 字段中输入以下内容</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://influxdb:8086</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 8:</strong> 在 <strong>Database</strong> 字段中输入以下内容，然后点击 <strong>Save &amp; Test</strong></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">iot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>注:</strong> 如果成功在Grafana上设置了<strong>InfluxDB</strong>数据源，您将看到 <strong>Data source is working</strong>的消息</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="创建一个google-cloud函数">创建一个Google Cloud函数<a href="#创建一个google-cloud函数" class="hash-link" aria-label="Direct link to 创建一个Google Cloud函数" title="Direct link to 创建一个Google Cloud函数">​</a></h4><p>现在我们需要创建一个Google Cloud函数，将Pub/Sub上的主题数据传输到InfluxDB，并使用交互式仪表板在Grafana上显示InfluxDB中的数据。</p><ul><li><p><strong>步骤 1:</strong> 返回到 <strong>Google Cloud Console</strong> 打开 <strong>Cloud Shell</strong></p></li><li><p><strong>步骤 2:</strong> 输入以下命令来启用 <strong>Cloud Functions API</strong></p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcloud services enable cloudfunctions.googleapis.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 3:</strong> 通过输入以下命令导航到 <strong>06-cloud_function</strong> 目录</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd esp32-cloud-iot-core-k8s-master/06-cloud_function</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>步骤 4:</strong>  使用 <strong>vim文本编辑器</strong> 打开 <strong>main.py</strong></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd esp32-cloud-iot-core-k8s-master/06-cloud_function</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>步骤 5:</strong> 在键盘上按下 <strong>i</strong> 进入 <strong>编辑模式</strong></p></li><li><p><strong>步骤 6:</strong> 修改<strong>_get_influxdb_client function</strong>中的 <strong>InfluxDB variables</strong> 主机、端口、用户名、密码）</p></li></ul><p><strong>注:</strong> 在Cloud Shell上输入以下命令以获取InfluxDB主机的外部IP地址，并将其复制</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get services</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>步骤 7:</strong> 输入 <strong>:wq</strong>来保存文件</p></li><li><p><strong>步骤 8:</strong> 输入以下命令来部署 <strong>Cloud Function</strong>  </p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">export PUBSUB_TOPIC=&quot;enter_topic-name&gt;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export REGION=&quot;enter_region&quot; # https://cloud.google.com/functions/docs/locations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcloud functions deploy iotcore_pubsub_to_influxdb --runtime python37 --trigger-topic $PUBSUB_TOPIC --region $REGION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="返回grafana设置">返回Grafana设置<a href="#返回grafana设置" class="hash-link" aria-label="Direct link to 返回Grafana设置" title="Direct link to 返回Grafana设置">​</a></h4><ul><li><p><strong>步骤 1:</strong> 打开Grafana，导航到 <code>Dashboards &gt; Manage</code></p></li><li><p><strong>步骤 2:</strong> 点击 <strong>New Dashboard</strong> 然后点击 <strong>Add new panel</strong></p></li><li><p><strong>步骤 3:</strong> 导航到 <strong>Visualization</strong> 点击 <strong>Graph</strong></p></li><li><p><strong>步骤 4:</strong> 在 <strong>Query</strong>下, 在 <strong>FROM</strong> 选项卡中, 点击 <strong>select measurement</strong> 然后从下拉菜单中选择 <strong>temperature</strong> </p></li><li><p><strong>步骤 5:</strong>  点击 <strong>+ Query</strong> 并重复 <strong>step 12</strong> 的步骤来选择 <strong>humidity</strong></p></li><li><p><strong>步骤 6:</strong> 根据您的偏好更改其他设置</p></li><li><p><strong>步骤 7:</strong> 点击 <strong>Apply</strong></p></li><li><p><strong>步骤 8:</strong> 点击 <strong>Add panel</strong> 然后点击 <strong>Add new panel</strong></p></li><li><p><strong>步骤 9:</strong> 导航到 <strong>Visualization</strong> 点击 <strong>Gauge</strong></p></li><li><p><strong>步骤 10:</strong> 在 <strong>Query</strong>下, 在 <strong>FROM</strong> 选项卡中，点击 <strong>select measurement</strong> 然后从下拉菜单中选择 <strong>temperature</strong> </p></li><li><p><strong>步骤 11:</strong> 在 <strong>Field</strong> 选项卡中, 在 <strong>Unit</strong>, 下，从下拉菜单中选择 <code>Temperature &gt; Celcius</code></p></li><li><p><strong>步骤 12:</strong> 通过在 <strong>Min</strong> 和 <strong>Max</strong>中输入值为仪表设置最小和最大值</p></li><li><p><strong>步骤 13:</strong> 在 <strong>Display name</strong>下, 输入 <code>Temperature</code></p></li><li><p><strong>步骤 14:</strong> 通过按照 <strong>step 15</strong>  重复相同的步骤 ，为<strong>humidity</strong>设置仪表</p></li><li><p><strong>步骤 15:</strong> 点击 <strong>Apply</strong></p></li></ul><p>现在您将在Grafana上看到创建的仪表板</p><p style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Google_Cloud_IoT/grafana_dash_1.png" alt="pir" width="900" height="auto" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="技术支持--产品讨论">技术支持 &amp; 产品讨论<a href="#技术支持--产品讨论" class="hash-link" aria-label="Direct link to 技术支持 &amp; 产品讨论" title="Direct link to 技术支持 &amp; 产品讨论">​</a></h2><p> 如果您遇到任何技术问题，请将问题提交到我们的 <a href="http://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer">论坛</a> 。
中。感谢您选择我们的产品！我们将为您提供不同的支持，以确保您使用我们的产品的体验尽可能顺利。我们提供多种沟通渠道，以满足不同的偏好和需求。</p><div class="button_tech_support_container"><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="button_forum"></a><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="button_email"></a></div><div class="button_tech_support_container"><a href="https://discord.gg/eWkprNDMU7" target="_blank" rel="noopener noreferrer" class="button_discord"></a><a href="https://github.com/Seeed-Studio/wiki-documents/discussions/69" target="_blank" rel="noopener noreferrer" class="button_discussion"></a></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/zh-CN/Sensor/Wio_Terminal/Application/Easy_IoT/CN-Connect-Wio-Terminal-to-Google-Cloud-IoT-Core.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-03-01T00:00:00.000Z">Mar 1, 2024</time></b> by <b>金菊</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cn/Wio-Terminal-Azure-IOT/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">将Wio Terminal连接到Microsoft Azure IoT</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cn/Get-Started-with-Wio-Terminal-and-Wappsto-IoT/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Wio Terminal和Wappsto IoT入门指南</div></a></nav></div><div>Loading Comments...</div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#引言" class="table-of-contents__link toc-highlight">引言</a><ul><li><a href="#什么是google-cloud" class="table-of-contents__link toc-highlight">什么是Google Cloud?</a></li><li><a href="#什么是google-cloud平台" class="table-of-contents__link toc-highlight">什么是Google Cloud平台?</a></li><li><a href="#什么是google-cloud-iot-core" class="table-of-contents__link toc-highlight">什么是Google Cloud IoT Core?</a></li><li><a href="#什么是google-cloud-console" class="table-of-contents__link toc-highlight">什么是Google Cloud Console?</a></li></ul></li><li><a href="#将wio-terminal通过mqtt连接到google-cloud-iot-core" class="table-of-contents__link toc-highlight">将Wio Terminal通过MQTT连接到Google Cloud IoT Core</a><ul><li><a href="#google-cloud-console-设置" class="table-of-contents__link toc-highlight">Google Cloud Console 设置</a><ul><li><a href="#初始设置" class="table-of-contents__link toc-highlight">初始设置</a></li><li><a href="#创建设备注册表" class="table-of-contents__link toc-highlight">创建设备注册表</a></li><li><a href="#生成设备密钥对-ec-keys" class="table-of-contents__link toc-highlight">生成设备密钥对 (EC Keys)</a></li><li><a href="#提取私钥" class="table-of-contents__link toc-highlight">提取私钥</a></li><li><a href="#将设备添加到注册表" class="table-of-contents__link toc-highlight">将设备添加到注册表</a></li><li><a href="#设置订阅者" class="table-of-contents__link toc-highlight">设置订阅者</a></li></ul></li><li><a href="#使用arduino设置wio-terminal" class="table-of-contents__link toc-highlight">使用Arduino设置Wio Terminal</a><ul><li><a href="#所需库" class="table-of-contents__link toc-highlight">所需库</a></li><li><a href="#配置凭据和帐户信息" class="table-of-contents__link toc-highlight">配置凭据和帐户信息</a></li><li><a href="#更改ntp时间方法" class="table-of-contents__link toc-highlight">更改NTP时间方法</a></li><li><a href="#在esp32-lwmqttino文件中添加宏定义" class="table-of-contents__link toc-highlight">在Esp32-lwmqtt.ino文件中添加宏定义</a></li></ul></li><li><a href="#显示遥测数据" class="table-of-contents__link toc-highlight">显示遥测数据</a></li><li><a href="#如何添加其他传感器" class="table-of-contents__link toc-highlight">如何添加其他传感器？</a><ul><li><a href="#google-cloud-iot设置" class="table-of-contents__link toc-highlight">Google Cloud IoT设置</a></li><li><a href="#arduino-设置" class="table-of-contents__link toc-highlight">Arduino 设置</a></li></ul></li><li><a href="#如何将其他传感器添加到wio-terminal并在仪表板上可视化数据" class="table-of-contents__link toc-highlight">如何将其他传感器添加到Wio Terminal并在仪表板上可视化数据？</a><ul><li><a href="#arduino的硬件设置" class="table-of-contents__link toc-highlight">Arduino的硬件设置</a></li><li><a href="#arduino的软件设置" class="table-of-contents__link toc-highlight">Arduino的软件设置</a></li><li><a href="#google-cloud-iot-设置" class="table-of-contents__link toc-highlight">Google Cloud IoT 设置</a></li><li><a href="#grafana-设置" class="table-of-contents__link toc-highlight">Grafana 设置</a></li><li><a href="#创建一个google-cloud函数" class="table-of-contents__link toc-highlight">创建一个Google Cloud函数</a></li><li><a href="#返回grafana设置" class="table-of-contents__link toc-highlight">返回Grafana设置</a></li></ul></li></ul></li><li><a href="#技术支持--产品讨论" class="table-of-contents__link toc-highlight">技术支持 &amp; 产品讨论</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Navigation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Getting_Started/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/Sensor_Network/">Sensor and Sensing</a></li><li class="footer__item"><a class="footer__link-item" href="/Network/">Network</a></li><li class="footer__item"><a class="footer__link-item" href="/Edge_Computing/">Edge Computing</a></li><li class="footer__item"><a class="footer__link-item" href="/Cloud/">Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/Solutions/">Solutions</a></li></ul></div><div class="col footer__col"><div class="footer__title">Ecosystem</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/QqMgVwHT3X" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://project.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project Hub</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/ecosystem/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partners</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/distributors.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Distributors</a></li></ul></div><div class="col footer__col"><div class="footer__title">Quick Guide</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bazzar</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/get_help/HowToGetHelp" target="_blank" rel="noopener noreferrer" class="footer__link-item">How to get help</a></li><li class="footer__item"><a href="https://support.seeedstudio.com/knowledgebase" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQs</a></li><li class="footer__item"><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/get_help/TechnicalSupport" target="_blank" rel="noopener noreferrer" class="footer__link-item">Technical Support</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.seeedstudio.com/about-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Seeed</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/join-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Join us</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/blog/2020/04/22/seeed-in-the-news/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Press</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Seeed Studio, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2d21728f.js"></script>
<script src="/assets/js/main.06a1b8bd.js"></script>
</body>
</html>